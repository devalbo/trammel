import{j as d,R as Yt,r as O}from"./index-DVz0_quL.js";import{M as Bo,o as Ho,s as _o,t as Go,d as Wo}from"./replicad_single-CHjvLvIh.js";const Nt=t=>typeof t,Kt="",Uo=Nt(Kt),Oo=Nt(!0),ks=Nt(0),qo=Nt(Nt),Pn="type",bt="default",Vn="allowNull",Jo="null",Xo="Listener",Yo="add",kt="Has",Qn="Ids",Xt="Table",Ls=Xt+"s",Ko=Xt+Qn,Gn="Row",Zo=Gn+"Count",Qo=Gn+Qn,_n="Cell",Ms=_n+Qn,Wn="Value",ws=Wn+"s",Io=Wn+Qn,z=t=>Kt+t,zs=t=>(n,s,o)=>t(n)?o?.():s(n),tr=isFinite,nr=(t,n)=>t instanceof n,Un=t=>t==null,I=t=>t===void 0,Dt=t=>t===null,er=zs(Un),U=zs(I),Fs=t=>t==Uo||t==Oo,fe=t=>Nt(t)==qo,Ds=t=>Array.isArray(t),Ts=(t,n,s)=>t.slice(n,s),Lt=t=>t.length,sr=(t,n)=>t.test(n),ue=async(t,n,s)=>{try{return await t()}catch(o){n?.(o)}},or=(t,n)=>t.includes(n),rr=(t,n)=>t.every(n),cr=(t,n)=>Lt(t)===Lt(n)&&rr(t,(s,o)=>n[o]===s),ir=(t,n)=>t.sort(n),dn=(t,n)=>t.forEach(n),On=(t,n)=>t.map(n),ar=(t,n,s)=>t.reduce(n,s),qn=(t,...n)=>t.push(...n),lr=t=>t.shift(),sn=t=>{if(Dt(t))return Jo;const n=Nt(t);return Fs(n)||n==ks&&tr(t)?n:void 0},$s=(t,n,s,o,c)=>I(c)?t.delCell(n,s,o,!0):t.setCell(n,s,o,c),js=(t,n,s)=>I(s)?t.delValue(n):t.setValue(n,s),Te=t=>n=>ar(fr(n),(s,o)=>s+t(o),0),$e=t=>t?.size??0,je=Te($e),an=Te(je),he=Te(an),Q=(t,n)=>t?.has(n)??!1,w=t=>I(t)||$e(t)==0,fr=t=>[...t?.values()??[]],de=t=>t.clear(),v=(t,n)=>t?.forEach(n),Jn=(t,n)=>t?.delete(n),Vt=Object,Rs=t=>Vt.getPrototypeOf(t),ur=Vt.isFrozen,Ns=Vt.entries,Xn=t=>!Un(t)&&er(Rs(t),n=>n==Vt.prototype||Un(Rs(n)),()=>!0),hr=Vt.keys,dr=Vt.freeze,yr=(t=[])=>Vt.fromEntries(t),ln=(t,n)=>n in t,Bs=(t,n)=>(delete t[n],t),xr=(t,n)=>dn(Ns(t),([s,o])=>n(o,s)),gr=(t,n)=>On(Ns(t),([s,o])=>n(o,s)),vt=(t,n)=>yr(gr(t,(s,o)=>[o,n(s,o)])),pr=t=>Lt(hr(t)),gt=t=>Xn(t)&&pr(t)==0,Rt=(t,n,s,o=0)=>Un(t)||!Xn(t)||!o&&gt(t)||ur(t)?(s?.(),!1):(xr(t,(c,a)=>{n(c,a)||Bs(t,a)}),o?!0:!gt(t)),T=t=>new Map(t),on=t=>[...t?.keys()??[]],m=(t,n)=>t?.get(n),Et=(t,n)=>v(t,(s,o)=>n(o,s)),mr=(t,n)=>On([...t?.entries()??[]],([s,o])=>n(o,s)),D=(t,n,s)=>I(s)?(Jn(t,n),t):t?.set(n,s),q=(t,n,s,o)=>(Q(t,n)?o?.(m(t,n)):D(t,n,s()),m(t,n)),zt=(t,n,s,o=D)=>(vt(n,(c,a)=>s(t,a,c)),Et(t,c=>ln(n,c)?0:o(t,c)),t),nt=(t,n,s,o)=>{const c={};return v(t,(a,f)=>{if(!s?.(a,f)){const h=n?n(a,f):a;o?.(h)||(c[f]=h)}}),c},ge=(t,n,s)=>nt(t,o=>nt(o,n,s),w,gt),kn=(t,n,s)=>nt(t,o=>ge(o,n,s),w,gt),At=(t,n)=>{const s=T();return v(t,(o,c)=>s.set(c,n?.(o)??o)),s},pe=t=>At(t,At),ye=t=>At(t,pe),me=(t,n,s,o,c=0)=>U((s?q:m)(t,n[c],c>Lt(n)-2?s:T),a=>{if(c>Lt(n)-2)return o?.(a)&&D(t,n[c]),a;const f=me(a,n,s,o,c+1);return w(a)&&D(t,n[c]),f}),fn=t=>new Set(Ds(t)||I(t)?t:[t]),un=(t,n)=>t?.add(n),Sr=/^\d+$/,Hs=()=>{const t=[];let n=0;return[s=>(s?lr(t):null)??Kt+n++,s=>{sr(Sr,s)&&Lt(t)<1e3&&qn(t,s)}]},Cr=(t,n=[Kt])=>{const s=[],o=(c,a)=>a==Lt(n)?qn(s,c):Dt(n[a])?v(c,f=>o(f,a+1)):dn([n[a],null],f=>o(m(c,f),a+1));return o(t,0),s},br=t=>{let n;const[s,o]=Hs(),c=T();return[(y,g,p,L=[],M=()=>[])=>{n??=t();const $=s(1);return D(c,$,[y,g,p,L,M]),un(me(g,p??[Kt],fn),$),$},(y,g,...p)=>dn(Cr(y,g),L=>v(L,M=>m(c,M)[0](n,...g??[],...p))),y=>U(m(c,y),([,g,p])=>(me(g,p??[Kt],void 0,L=>(Jn(L,y),w(L)?1:0)),D(c,y),o(y),p)),y=>U(m(c,y),([g,,p=[],L,M])=>{const $=(...F)=>{const _=Lt(F);_==Lt(p)?g(n,...F,...M(F)):Dt(p[_])?dn(L[_]?.(...F)??[],J=>$(...F,J)):$(...F,p[_])};$()})]},Lr=JSON.stringify,xe=JSON.parse,qt=t=>Lr(t,(n,s)=>nr(s,Map)?Vt.fromEntries([...s]):s),Mr=(t,n)=>(t??0)<(n??0)?-1:1,zn=t=>[t,t],B=(t,n=je)=>n(t[0])+n(t[1]),H=()=>[T(),T()],vs=t=>[...t],Fn=([t,n])=>t===n,rn=(t,n,s)=>D(t,n,m(t,n)==-s?void 0:s),_s=()=>{let t,n,s=!1,o=!1,c=0,a=[];const f=T(),h=T(),S=T(),y=T(),g=T(),p=T(),L=T(),M=T(),$=T(),F=T(),_=T(),J=T(),ot=T(),pt=T(),Mt=fn(),ht=T(),dt=T(),A=T(),G=T(),rt=H(),wt=H(),yt=H(),at=H(),K=H(),b=H(),E=H(),P=H(),Z=H(),lt=H(),xt=H(),ft=H(),ct=H(),mt=H(),Gt=H(),Wt=H(),Tt=H(),xn=H(),Qt=H(),It=H(),X=H(),j=H(),tt=T(),it=H(),[$t,W,eo,so]=br(()=>Y),oo=e=>Rt(e,r=>Rt(r,Ae)),ro=e=>Rt(e,Ae),Ae=e=>{if(!Rt(e,(l,u)=>or([Pn,bt,Vn],u)))return!1;const r=e[Pn];if(!Fs(r)&&r!=ks)return!1;const i=e[bt];return Dt(i)&&!e[Vn]?!1:(!Dt(i)&&sn(i)!=r&&Bs(e,bt),!0)},co=Ds,io=e=>Rt(e,Pe,St),Pe=(e,r)=>(!t||Q(_,r)||St(r))&&Rt(e,(i,l)=>gn(r,l,i),()=>St(r)),gn=(e,r,i,l)=>Rt(l?i:Fe(i,e,r),(u,x)=>U(Ve(e,r,x,u),C=>(i[x]=C,!0),()=>!1),()=>St(e,r)),Ve=(e,r,i,l)=>t?U(m(m(_,e),i),u=>Dt(l)?u[Vn]?l:St(e,r,i,l,u[bt]):sn(l)==u[Pn]?l:St(e,r,i,l,u[bt]),()=>St(e,r,i,l)):I(sn(l))?St(e,r,i,l):l,ke=(e,r)=>Rt(r?e:ao(e),(i,l)=>U(ze(l,i),u=>(e[l]=u,!0),()=>!1),()=>Ut()),ze=(e,r)=>n?U(m(ot,e),i=>Dt(r)?i[Vn]?r:Ut(e,r,i[bt]):sn(r)==i[Pn]?r:Ut(e,r,i[bt]),()=>Ut(e,r)):I(sn(r))?Ut(e,r):r,Fe=(e,r,i)=>(U(m(J,r),([l,u])=>{v(l,(x,C)=>{ln(e,C)||(e[C]=x)}),v(u,x=>{ln(e,x)||St(r,i,x)})}),e),ao=e=>(n&&(v(pt,(r,i)=>{ln(e,i)||(e[i]=r)}),v(Mt,r=>{ln(e,r)||Ut(r)})),e),De=e=>zt(_,e,(r,i,l)=>{const u=T(),x=fn();zt(q(_,i,T),l,(C,V,k)=>{D(C,V,k),U(k[bt],Ct=>D(u,V,Ct),()=>un(x,V))}),D(J,i,[u,x])},(r,i)=>{D(_,i),D(J,i)}),Ne=e=>zt(ot,e,(r,i,l)=>{D(ot,i,l),U(l[bt],u=>D(pt,i,u),()=>un(Mt,i))},(r,i)=>{D(ot,i),D(pt,i),Jn(Mt,i)}),Be=e=>gt(e)?Rn():$n(e),lo=([e,r])=>{(gt(e)?Rn:$n)(e),(gt(r)?vn:jn)(r)},He=e=>zt(A,e,(r,i,l)=>pn(i,l),(r,i)=>Ue(i)),pn=(e,r)=>zt(q(A,e,()=>(Xe(e,1),D(ht,e,Hs()),D(dt,e,T()),T())),r,(i,l,u)=>tn(e,i,l,u),(i,l)=>Oe(e,i,l)),tn=(e,r,i,l,u)=>zt(q(r,i,()=>(Ye(e,i,1),T())),l,(x,C,V)=>se(e,i,x,C,V),(x,C)=>qe(e,r,i,x,C,u)),se=(e,r,i,l,u)=>{Q(i,l)||Ke(e,r,l,1);const x=m(i,l);u!==x&&(Ze(e,r,l,x,u),D(i,l,u))},_e=(e,r,i,l,u)=>U(m(r,i),x=>se(e,i,x,l,u),()=>tn(e,r,i,Fe({[l]:u},e,i))),Ge=e=>gt(e)?vn():jn(e),We=e=>zt(G,e,(r,i,l)=>mn(i,l),(r,i)=>Je(i)),mn=(e,r)=>{Q(G,e)||Qe(e,1);const i=m(G,e);r!==i&&(Ie(e,i,r),D(G,e,r))},fo=(e,r)=>{const[i]=m(ht,e);let l;do l=i(r);while(Q(m(A,e),l));return l},Sn=e=>m(A,e)??pn(e,{}),Ue=e=>pn(e,{}),Oe=(e,r,i)=>{const[,l]=m(ht,e);l(i),tn(e,r,i,{},!0)},qe=(e,r,i,l,u,x)=>{const C=m(m(J,e)?.[0],u);if(!I(C)&&!x)return se(e,i,l,u,C);const V=k=>{Ze(e,i,k,m(l,k)),Ke(e,i,k,-1),D(l,k)};I(C)?V(u):Et(l,V),w(l)&&(Ye(e,i,-1),w(D(r,i))&&(Xe(e,-1),D(A,e),D(ht,e),D(dt,e)))},Je=e=>{const r=m(pt,e);if(!I(r))return mn(e,r);Ie(e,m(G,e)),Qe(e,-1),D(G,e)},Xe=(e,r)=>rn(f,e,r),Ye=(e,r,i)=>rn(q(y,e,T),r,i)&&D(S,e,q(S,e,()=>0)+i),Ke=(e,r,i,l)=>{const u=m(dt,e),x=m(u,i)??0;(x==0&&l==1||x==1&&l==-1)&&rn(q(h,e,T),i,l),D(u,i,x!=-l?x+l:void 0),rn(q(q(g,e,T),r,T),i,l)},Ze=(e,r,i,l,u)=>{q(q(q(p,e,T),r,T),i,()=>[l,0])[1]=u,a[3]?.(e,r,i,u)},Qe=(e,r)=>rn(L,e,r),Ie=(e,r,i)=>{q(M,e,()=>[r,0])[1]=i,a[4]?.(e,i)},St=(e,r,i,l,u)=>(qn(q(q(q($,e,T),r,T),i,()=>[]),l),u),Ut=(e,r,i)=>(qn(q(F,e,()=>[]),r),i),Cn=(e,r,i)=>U(m(m(m(p,e),r),i),([l,u])=>[!0,l,u],()=>[!1,...zn(Ln(e,r,i))]),ts=e=>U(m(M,e),([r,i])=>[!0,r,i],()=>[!1,...zn(Mn(e))]),ns=e=>!w($)&&!w(Wt[e])?v(e?ye($):$,(r,i)=>v(r,(l,u)=>v(l,(x,C)=>W(Wt[e],[i,u,C],x)))):0,es=e=>!w(F)&&!w(Tt[e])?v(e?At(F):F,(r,i)=>W(Tt[e],[i],r)):0,nn=(e,r,i,l)=>{if(!w(e))return W(r,l,()=>nt(e)),Et(e,(u,x)=>W(i,[...l??[],u],x==1)),1},ss=e=>{const r=wn();r!=s&&W(rt[e],void 0,r);const i=w(lt[e]),l=w(ct[e])&&w(mt[e])&&w(Z[e])&&w(xt[e])&&w(b[e])&&w(E[e])&&w(P[e])&&i&&w(yt[e])&&w(at[e]),u=w(Gt[e])&&w(ft[e])&&w(K[e])&&w(wt[e]);if(!l||!u){const x=e?[At(f),pe(h),At(S),pe(y),ye(g),ye(p)]:[f,h,S,y,g,p];if(!l){nn(x[0],yt[e],at[e]),v(x[1],(V,k)=>nn(V,b[e],E[e],[k])),v(x[2],(V,k)=>{V!=0&&W(P[e],[k],is(k))});const C=fn();v(x[3],(V,k)=>{nn(V,Z[e],xt[e],[k])&&!i&&(W(lt[e],[k,null]),un(C,k))}),i||v(x[5],(V,k)=>{if(!Q(C,k)){const Ct=fn();v(V,jt=>v(jt,([En,An],en)=>An!==En?un(Ct,en):Jn(jt,en))),v(Ct,jt=>W(lt[e],[k,jt]))}}),v(x[4],(V,k)=>v(V,(Ct,jt)=>nn(Ct,ct[e],mt[e],[k,jt])))}if(!u){let C;v(x[5],(V,k)=>{let Ct;v(V,(jt,En)=>{let An;v(jt,([en,bs],No)=>{bs!==en&&(W(Gt[e],[k,En,No],bs,en,Cn),C=Ct=An=1)}),An&&W(ft[e],[k,En],Cn)}),Ct&&W(K[e],[k],Cn)}),C&&W(wt[e],void 0,Cn)}}},os=e=>{const r=Tn();r!=o&&W(xn[e],void 0,r);const i=w(It[e])&&w(X[e]),l=w(j[e])&&w(Qt[e]);if(!i||!l){const u=e?[At(L),At(M)]:[L,M];if(i||nn(u[0],It[e],X[e]),!l){let x;v(u[1],([C,V],k)=>{V!==C&&(W(j[e],[k],V,C,ts),x=1)}),x&&W(Qt[e],void 0,ts)}}},N=(e,...r)=>(le(()=>e(...On(r,z))),Y),rs=(e,r,i,l,u)=>{let x=bn(e,r,...i);return $t(()=>{const C=bn(e,r,...i);cr(C,x)||(x=C,l(Y,e,r,...i,x))},lt[u?1:0],[e,r],[st])},uo=()=>[oe(),ce()],oe=()=>kn(A),st=()=>on(A),ho=e=>ge(m(A,z(e))),cs=e=>on(m(dt,z(e))),is=e=>$e(m(A,z(e))),Ot=e=>on(m(A,z(e))),bn=(e,r,i,l=0,u)=>Xn(e)?bn(e.tableId,e.cellId,e.descending,e.offset,e.limit):On(Ts(ir(mr(m(A,z(e)),(x,C)=>[I(r)?C:m(x,z(r)),C]),([x],[C])=>Mr(x,C)*(i?-1:1)),l,I(u)?u:l+u),([,x])=>x),yo=(e,r)=>nt(m(m(A,z(e)),z(r))),re=(e,r)=>on(m(m(A,z(e)),z(r))),Ln=(e,r,i)=>m(m(m(A,z(e)),z(r)),z(i)),ce=()=>nt(G),ie=()=>on(G),Mn=e=>m(G,z(e)),wn=()=>!w(A),as=e=>Q(A,z(e)),ls=(e,r)=>Q(m(dt,z(e)),z(r)),fs=(e,r)=>Q(m(A,z(e)),z(r)),us=(e,r,i)=>Q(m(m(A,z(e)),z(r)),z(i)),Tn=()=>!w(G),hs=e=>Q(G,z(e)),xo=()=>qt(A),go=()=>qt(G),po=()=>qt([A,G]),mo=()=>qt(_),So=()=>qt(ot),Co=()=>qt([_,ot]),bo=e=>N(()=>{const r=fe(e)?e():e;co(r)&&lo(r)}),$n=e=>N(()=>io(e)?He(e):0),Lo=(e,r)=>N(i=>Pe(r,i)?pn(i,r):0,e),Mo=(e,r,i)=>N((l,u)=>gn(l,u,i)?tn(l,Sn(l),u,i):0,e,r),wo=(e,r,i=!0)=>le(()=>{let l;return gn(e,l,r)&&(e=z(e),tn(e,Sn(e),l=fo(e,i?1:0),r)),l}),To=(e,r,i)=>N((l,u)=>{if(gn(l,u,i,1)){const x=Sn(l);vt(i,(C,V)=>_e(l,x,u,V,C))}},e,r),$o=(e,r,i,l)=>N((u,x,C)=>U(Ve(u,x,C,fe(l)?l(Ln(u,x,C)):l),V=>_e(u,Sn(u),x,C,V)),e,r,i),jn=e=>N(()=>ke(e)?We(e):0),jo=e=>N(()=>ke(e,1)?vt(e,(r,i)=>mn(i,r)):0),Ro=(e,r)=>N(i=>U(ze(i,fe(r)?r(Mn(i)):r),l=>mn(i,l)),e),vo=e=>N(()=>{vt(e[0],(r,i)=>I(r)?gs(i):vt(r,(l,u)=>I(l)?ps(i,u):vt(l,(x,C)=>$s(Y,i,u,C,x)))),vt(e[1],(r,i)=>js(Y,i,r))}),ds=e=>(ue(()=>Be(xe(e))),Y),Eo=e=>(ue(()=>Ge(xe(e))),Y),Ao=e=>N(()=>ue(()=>{const[r,i]=xe(e);Be(r),Ge(i)},()=>ds(e))),ys=e=>N(()=>{if((t=oo(e))&&(De(e),!w(A))){const r=oe();Rn(),$n(r)}}),xs=e=>N(()=>{if(n=ro(e)){const r=ce();ae(),vn(),n=!0,Ne(e),jn(r)}}),Po=(e,r)=>N(()=>{ys(e),xs(r)}),Rn=()=>N(()=>He({})),gs=e=>N(r=>Q(A,r)?Ue(r):0,e),ps=(e,r)=>N((i,l)=>U(m(A,i),u=>Q(u,l)?Oe(i,u,l):0),e,r),Vo=(e,r,i,l)=>N((u,x,C)=>U(m(A,u),V=>U(m(V,x),k=>Q(k,C)?qe(u,V,x,k,C,l):0)),e,r,i),vn=()=>N(()=>We({})),ko=e=>N(r=>Q(G,r)?Je(r):0,e),ms=()=>N(()=>{De({}),t=!1}),ae=()=>N(()=>{Ne({}),n=!1}),zo=()=>N(()=>{ms(),ae()}),le=(e,r)=>{if(c!=-1){Ss();const i=e();return Cs(r),i}},Ss=()=>(c!=-1&&c++,c==1&&(a[0]?.(),W(tt)),Y),Fo=()=>[nt(p,(e,r)=>m(f,r)===-1?void 0:nt(e,(i,l)=>m(m(y,r),l)===-1?void 0:nt(i,([,u])=>u,u=>Fn(u)),w,gt),w,gt),nt(M,([,e])=>e,e=>Fn(e)),1],Do=()=>[!w(p),!w(M),kn(p,vs,Fn),kn($),nt(M,vs,Fn),nt(F),nt(f),ge(y),kn(g),nt(L)],Cs=e=>(c>0&&(c--,c==0&&(c=1,ns(1),w(p)||ss(1),es(1),w(M)||os(1),e?.(Y)&&(v(p,(r,i)=>v(r,(l,u)=>v(l,([x],C)=>$s(Y,i,u,C,x)))),de(p),v(M,([r],i)=>js(Y,i,r)),de(M)),W(it[0],void 0),c=-1,ns(0),w(p)||ss(0),es(0),w(M)||os(0),a[1]?.(),W(it[1],void 0),a[2]?.(),c=0,s=wn(),o=Tn(),dn([f,h,S,y,g,p,$,L,M,F],de))),Y),Y={getContent:uo,getTables:oe,getTableIds:st,getTable:ho,getTableCellIds:cs,getRowCount:is,getRowIds:Ot,getSortedRowIds:bn,getRow:yo,getCellIds:re,getCell:Ln,getValues:ce,getValueIds:ie,getValue:Mn,hasTables:wn,hasTable:as,hasTableCell:ls,hasRow:fs,hasCell:us,hasValues:Tn,hasValue:hs,getTablesJson:xo,getValuesJson:go,getJson:po,getTablesSchemaJson:mo,getValuesSchemaJson:So,getSchemaJson:Co,hasTablesSchema:()=>t,hasValuesSchema:()=>n,setContent:bo,setTables:$n,setTable:Lo,setRow:Mo,addRow:wo,setPartialRow:To,setCell:$o,setValues:jn,setPartialValues:jo,setValue:Ro,applyChanges:vo,setTablesJson:ds,setValuesJson:Eo,setJson:Ao,setTablesSchema:ys,setValuesSchema:xs,setSchema:Po,delTables:Rn,delTable:gs,delRow:ps,delCell:Vo,delValues:vn,delValue:ko,delTablesSchema:ms,delValuesSchema:ae,delSchema:zo,transaction:le,startTransaction:Ss,getTransactionChanges:Fo,getTransactionLog:Do,finishTransaction:Cs,forEachTable:e=>v(A,(r,i)=>e(i,l=>v(r,(u,x)=>l(x,C=>Et(u,C))))),forEachTableCell:(e,r)=>Et(m(dt,z(e)),r),forEachRow:(e,r)=>v(m(A,z(e)),(i,l)=>r(l,u=>Et(i,u))),forEachCell:(e,r,i)=>Et(m(m(A,z(e)),z(r)),i),forEachValue:e=>Et(G,e),addSortedRowIdsListener:(e,r,i,l,u,x,C)=>Xn(e)?rs(e.tableId,e.cellId,[e.descending??!1,e.offset??0,e.limit],r,i):rs(e,r,[i,l,u],x,C),addStartTransactionListener:e=>$t(e,tt),addWillFinishTransactionListener:e=>$t(e,it[0]),addDidFinishTransactionListener:e=>$t(e,it[1]),callListener:e=>(so(e),Y),delListener:e=>(eo(e),Y),getListenerStats:()=>({hasTables:B(rt),tables:B(wt),tableIds:B(yt),hasTable:B(at),table:B(K),tableCellIds:B(b),hasTableCell:B(E,an),rowCount:B(P),rowIds:B(Z),sortedRowIds:B(lt),hasRow:B(xt,an),row:B(ft,an),cellIds:B(ct,an),hasCell:B(mt,he),cell:B(Gt,he),invalidCell:B(Wt,he),hasValues:B(xn),values:B(Qt),valueIds:B(It),hasValue:B(X),value:B(j),invalidValue:B(Tt),transaction:je(tt)+B(it)}),isMergeable:()=>!1,createStore:_s,addListener:$t,callListeners:W,setInternalListeners:(e,r,i,l,u)=>a=[e,r,i,l,u]};return vt({[kt+Ls]:[0,rt,[],()=>[wn()]],[Ls]:[0,wt],[Ko]:[0,yt],[kt+Xt]:[1,at,[st],e=>[as(...e)]],[Xt]:[1,K,[st]],[Xt+Ms]:[1,b,[st]],[kt+Xt+_n]:[2,E,[st,cs],e=>[ls(...e)]],[Zo]:[1,P,[st]],[Qo]:[1,Z,[st]],[kt+Gn]:[2,xt,[st,Ot],e=>[fs(...e)]],[Gn]:[2,ft,[st,Ot]],[Ms]:[2,ct,[st,Ot]],[kt+_n]:[3,mt,[st,Ot,re],e=>[us(...e)]],[_n]:[3,Gt,[st,Ot,re],e=>zn(Ln(...e))],InvalidCell:[3,Wt],[kt+ws]:[0,xn,[],()=>[Tn()]],[ws]:[0,Qt],[Io]:[0,It],[kt+Wn]:[1,X,[ie],e=>[hs(...e)]],[Wn]:[1,j,[ie],e=>zn(Mn(e[0]))],InvalidValue:[1,Tt]},([e,r,i,l],u)=>{Y[Yo+u+Xo]=(...x)=>$t(x[e],r[x[e+1]?1:0],e>0?Ts(x,0,e):void 0,i,l)}),dr(Y)},Yn="",Gs="￼",Ws=t=>(n,s,o)=>t(n)?o?.():s(n),wr=globalThis,Es=wr.window,Se=t=>t==null,Pt=t=>t===void 0,Us=t=>t===null,Tr=Ws(Se),Ce=Ws(Pt),be=t=>Array.isArray(t),Bt=t=>t.length,$r=(t,n)=>t.test(n),Os=t=>{throw new Error(t)},Jt=async(t,n,s)=>{try{return await t()}catch(o){n?.(o)}},Le=(t,n)=>t.forEach(n),jr=(t,n)=>t.splice(0,n),Re=(t,...n)=>t.push(...n),qs=t=>t.shift(),In=Object,As=t=>In.getPrototypeOf(t),Rr=t=>!Se(t)&&Tr(As(t),n=>n==In.prototype||Se(As(n)),()=>!0),vr=In.keys,Er=In.freeze,Ar=t=>Bt(vr(t)),Dn=t=>Rr(t)&&Ar(t)==0,Pr=JSON.stringify,Vr=JSON.parse,kr=t=>Pr(t,(n,s)=>Pt(s)?Gs:s),Ps=t=>Vr(t,(n,s)=>s===Gs?void 0:s),zr=t=>t?.size??0,Fr=(t,n)=>t?.has(n)??!1,Js=t=>Pt(t)||zr(t)==0,Xs=(t,n)=>t?.forEach(n),Ys=(t,n)=>t?.delete(n),yn=t=>new Map(t),ut=(t,n)=>t?.get(n),Ht=(t,n,s)=>Pt(s)?(Ys(t,n),t):t?.set(n,s),Me=(t,n,s,o)=>(Fr(t,n)?o?.(ut(t,n)):Ht(t,n,s()),ut(t,n)),we=(t,n,s,o,c=0)=>Ce((s?Me:ut)(t,n[c],c>Bt(n)-2?s:yn),a=>{if(c>Bt(n)-2)return o?.(a)&&Ht(t,n[c]),a;const f=we(a,n,s,o,c+1);return Js(a)&&Ht(t,n[c]),f}),Dr=/^\d+$/,Nr=()=>{const t=[];let n=0;return[s=>(s?qs(t):null)??Yn+n++,s=>{$r(Dr,s)&&Bt(t)<1e3&&Re(t,s)}]},Br=t=>new Set(be(t)||Pt(t)?t:[t]),Hr=(t,n)=>t?.add(n),_r=(t,n=[Yn])=>{const s=[],o=(c,a)=>a==Bt(n)?Re(s,c):Us(n[a])?Xs(c,f=>o(f,a+1)):Le([n[a],null],f=>o(ut(c,f),a+1));return o(t,0),s},Gr=t=>{let n;const[s,o]=Nr(),c=yn();return[(y,g,p,L=[],M=()=>[])=>{n??=t();const $=s(1);return Ht(c,$,[y,g,p,L,M]),Hr(we(g,p??[Yn],Br),$),$},(y,g,...p)=>Le(_r(y,g),L=>Xs(L,M=>ut(c,M)[0](n,...g??[],...p))),y=>Ce(ut(c,y),([,g,p])=>(we(g,p??[Yn],void 0,L=>(Ys(L,y),Js(L)?1:0)),Ht(c,y),o(y),p)),y=>Ce(ut(c,y),([g,,p=[],L,M])=>{const $=(...F)=>{const _=Bt(F);_==Bt(p)?g(n,...F,...M(F)):Us(p[_])?Le(L[_]?.(...F)??[],J=>$(...F,J)):$(...F,p[_])};$()})]},Nn=yn(),Bn=yn(),Wr=(t=1,n,s)=>t!=1&&n.isMergeable()?[1,n.getMergeableContent,()=>n.getTransactionMergeableChanges(!s),([[o],[c]])=>!Dn(o)||!Dn(c),n.setDefaultContent]:t!=2?[0,n.getContent,n.getTransactionChanges,([o,c])=>!Dn(o)||!Dn(c),n.setContent]:Os("Store type not supported by this Persister"),Ur=(t,n,s,o,c,a,f,h={},S=0,y=[])=>{let g=0,p=0,L=0,M,$,F;Me(Nn,y,()=>0),Me(Bn,y,()=>[]);const _=yn(),[J,ot,pt,Mt,ht]=Wr(f,t,S),[dt,A,G]=Gr(()=>X),rt=j=>{j!=g&&(g=j,A(_,void 0,g))},wt=async()=>{if(!ut(Nn,y)){for(Ht(Nn,y,1);!Pt(M=qs(ut(Bn,y)));)await Jt(M,a);Ht(Nn,y,0)}},yt=j=>{(J&&be(j?.[0])?j?.[2]===1?t.applyMergeableChanges:t.setMergeableContent:j?.[2]===1?t.applyChanges:t.setContent)(j)},at=async j=>(g!=2&&(rt(1),p++,await Tt(async()=>{await Jt(async()=>{const tt=await n();be(tt)?yt(tt):j?ht(j):Os(`Content is not an array: ${tt}`)},()=>{j&&ht(j)}),rt(0)})),X),K=async j=>(b(),await at(j),await Jt(async()=>$=await o(async(tt,it)=>{it||tt?g!=2&&(rt(1),p++,yt(it??tt),rt(0)):await at()}),a),X),b=async()=>($&&(await Jt(()=>c($),a),$=void 0),X),E=()=>!Pt($),P=async j=>(g!=1&&(rt(2),L++,await Tt(async()=>{await Jt(()=>s(ot,j),a),rt(0)})),X),Z=async()=>(lt(),await P(),F=t.addDidFinishTransactionListener(()=>{const j=pt();Mt(j)&&P(j)}),X),lt=async()=>(F&&(t.delListener(F),F=void 0),X),xt=()=>!Pt(F),ft=async(j,tt=!1)=>{const[it,$t]=tt?[Z,K]:[K,Z];return await it(j),await $t(j),X},ct=async(j=!1)=>{const[tt,it]=j?[lt,b]:[b,lt];return await tt(),await it(),X},mt=()=>g,Gt=j=>dt(j,_),Wt=j=>(G(j),t),Tt=async(...j)=>(Re(ut(Bn,y),...j),await wt(),X),X={load:at,startAutoLoad:K,stopAutoLoad:b,isAutoLoading:E,save:P,startAutoSave:Z,stopAutoSave:lt,isAutoSaving:xt,startAutoPersisting:ft,stopAutoPersisting:ct,getStatus:mt,addStatusListener:Gt,delListener:Wt,schedule:Tt,getStore:()=>t,destroy:()=>(jr(ut(Bn,y)),ct()),getStats:()=>({loads:p,saves:L}),...h};return Er(X)},Vs="storage",Or=(t,n,s,o)=>Ur(t,async()=>Ps(s.getItem(n)),async S=>s.setItem(n,kr(S())),S=>{const y=g=>{g.storageArea===s&&g.key===n&&Jt(()=>S(Ps(g.newValue)),S)};return Es.addEventListener(Vs,y),y},S=>Es.removeEventListener(Vs,S),o,3,{getStorageName:()=>n}),qr=(t,n,s)=>Or(t,n,localStorage,s);function Jr(){return _s()}function Xr(t){return qr(t,"trammel-claude")}function te(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function Ks(t,n){switch(n){case"topLeft":return{x:t.x,y:t.y};case"topRight":return{x:t.x+t.width,y:t.y};case"bottomLeft":return{x:t.x,y:t.y+t.height};case"bottomRight":return{x:t.x+t.width,y:t.y+t.height}}}function ve(t,n){switch(n){case"top":return{x:t.x+t.width/2,y:t.y};case"bottom":return{x:t.x+t.width/2,y:t.y+t.height};case"left":return{x:t.x,y:t.y+t.height/2};case"right":return{x:t.x+t.width,y:t.y+t.height/2}}}function hn(t,n){switch(n){case"top":return{from:{x:t.x,y:t.y},to:{x:t.x+t.width,y:t.y}};case"bottom":return{from:{x:t.x,y:t.y+t.height},to:{x:t.x+t.width,y:t.y+t.height}};case"left":return{from:{x:t.x,y:t.y},to:{x:t.x,y:t.y+t.height}};case"right":return{from:{x:t.x+t.width,y:t.y},to:{x:t.x+t.width,y:t.y+t.height}}}}function ne(t){return{x:t.cx,y:t.cy}}function Yr(t){return{x:t.cx-t.r,y:t.cy-t.r,width:t.r*2,height:t.r*2}}function _t(t){const n=t.to.x-t.from.x,s=t.to.y-t.from.y;return Math.sqrt(n*n+s*s)}function et(t){return Math.atan2(t.to.y-t.from.y,t.to.x-t.from.x)}function Kr(t){const n=_t(t);return n===0?{x:0,y:0}:{x:(t.to.x-t.from.x)/n,y:(t.to.y-t.from.y)/n}}function ee(t,n){const s=n.x-t.x,o=n.y-t.y;return Math.sqrt(s*s+o*o)}function Zr(t,n){const s=n.to.x-n.from.x,o=n.to.y-n.from.y,c=Math.sqrt(s*s+o*o);return c===0?ee(t,n.from):Math.abs(s*(n.from.y-t.y)-o*(n.from.x-t.x))/c}function Qr(t,n){return Math.abs(ee(t,{x:n.cx,y:n.cy})-n.r)}function Ee(t,n){const s=t.from.x,o=t.from.y,c=t.to.x,a=t.to.y,f=n.from.x,h=n.from.y,S=n.to.x,y=n.to.y,g=(s-c)*(h-y)-(o-a)*(f-S);if(Math.abs(g)<1e-10)return null;const p=((s-f)*(h-y)-(o-h)*(f-S))/g;return{x:s+p*(c-s),y:o+p*(a-o)}}function Ir(t,n){const s=t.to.x-t.from.x,o=t.to.y-t.from.y,c=t.from.x-n.cx,a=t.from.y-n.cy,f=s*s+o*o,h=2*(c*s+a*o),S=c*c+a*a-n.r*n.r,y=h*h-4*f*S;if(y<0)return[];const g=[],p=Math.sqrt(y);for(const L of[-1,1]){const M=(-h+L*p)/(2*f);M>=0&&M<=1&&g.push({x:t.from.x+M*s,y:t.from.y+M*o})}return g}function tc(t,n){const s=ee({x:t.cx,y:t.cy},{x:n.cx,y:n.cy});if(s>t.r+n.r||s<Math.abs(t.r-n.r)||s===0)return[];const o=(t.r*t.r-n.r*n.r+s*s)/(2*s),c=Math.sqrt(t.r*t.r-o*o),a=t.cx+o*(n.cx-t.cx)/s,f=t.cy+o*(n.cy-t.cy)/s,h=-c*(n.cy-t.cy)/s,S=c*(n.cx-t.cx)/s;return[{x:a+h,y:f+S},{x:a-h,y:f-S}]}function nc(t,n){const s=[hn(n,"top"),hn(n,"bottom"),hn(n,"left"),hn(n,"right")],o=[];for(const c of s){const a=Ee(t,c);if(a){const f=Math.min(c.from.x,c.to.x)-1e-10,h=Math.max(c.from.x,c.to.x)+1e-10,S=Math.min(c.from.y,c.to.y)-1e-10,y=Math.max(c.from.y,c.to.y)+1e-10;a.x>=f&&a.x<=h&&a.y>=S&&a.y<=y&&o.push(a)}}return o}function Kn(t){return"width"in t?te(t):ne(t)}function ec(t,n){const s=Kn(t),o=Kn(n);return{x:s.x,y:o.y}}function sc(t,n){const s=Kn(t);return{x:Kn(n).x,y:s.y}}function Zn(t,n){switch(n){case"top":return t.y;case"bottom":return t.y+t.height;case"left":return t.x;case"right":return t.x+t.width}}function oc(t,n,s,o){const c=Zn(t,n),a=Zn(s,o);return o==="top"||o==="bottom"?{x:s.x,y:s.y+(c-a)}:{x:s.x+(c-a),y:s.y}}function rc(t,n,s,o){return Zn(t,n)-Zn(s,o)}function Zs(t,n,s){if(t<=0)return[];const o=(s-t*n)/(t+1);return Array.from({length:t},(c,a)=>o+a*(n+o))}function cc(t,n,s,o){if(t<=0)return[];const c=o==="top"||o==="bottom",a=c?s.width:s.height,f=Zs(t,n,a),h=ve(s,o);if(c){const y=h.y;return f.map(g=>({x:s.x+g,y}))}const S=h.x;return f.map(y=>({x:S,y:s.y+y}))}function ic(t,n,s,o,c){const a=[];for(let f=0;f<n;f++)for(let h=0;h<t;h++)a.push({x:h*(s+c),y:f*(o+c)});return a}function ac(t,n,s=0){if(t<=0)return[];const o=2*Math.PI/t;return Array.from({length:t},(c,a)=>{const f=s+a*o;return{x:n.cx+n.r*Math.cos(f),y:n.cy+n.r*Math.sin(f)}})}function lc(t,n,s){return{x:t.x+n*Math.cos(s),y:t.y+n*Math.sin(s)}}function fc(t,n){const s=et(t)+Math.PI/2,o=n*Math.cos(s),c=n*Math.sin(s);return{from:{x:t.from.x+o,y:t.from.y+c},to:{x:t.to.x+o,y:t.to.y+c}}}function Qs(t,n){return typeof n=="number"?{x:t.x+n,y:t.y+n,width:t.width-n*2,height:t.height-n*2}:{x:t.x+n.left,y:t.y+n.top,width:t.width-n.left-n.right,height:t.height-n.top-n.bottom}}function uc(t,n){return{cx:t.cx,cy:t.cy,r:t.r+n}}function Is(t,n,s){const o=Ee(n,s);if(!o)return{cx:0,cy:0,r:t,startAngle:0,endAngle:Math.PI/2};const c=et(n),a=et(s),f=(c+a)/2,h=Math.abs(a-c)/2,S=t/Math.sin(h||.001),y=o.x+S*Math.cos(f),g=o.y+S*Math.sin(f);return{cx:y,cy:g,r:t,startAngle:c-Math.PI/2,endAngle:a-Math.PI/2}}function hc(t,n,s){let o,c,a,f;switch(s){case"topLeft":o=n.x+t,c=n.y+t,a=Math.PI,f=1.5*Math.PI;break;case"topRight":o=n.x+n.width-t,c=n.y+t,a=1.5*Math.PI,f=2*Math.PI;break;case"bottomLeft":o=n.x+t,c=n.y+n.height-t,a=.5*Math.PI,f=Math.PI;break;case"bottomRight":o=n.x+n.width-t,c=n.y+n.height-t,a=0,f=.5*Math.PI;break}return{cx:o,cy:c,r:t,startAngle:a,endAngle:f}}function dc(t,n,s,o="ccw"){const c=(t.x+n.x)/2,a=(t.y+n.y)/2,f=n.x-t.x,h=n.y-t.y,S=Math.sqrt(f*f+h*h)/2,y=Math.sqrt(Math.max(0,s*s-S*S)),g=o==="ccw"?1:-1,p=c+g*y*(-h/(2*S)),L=a+g*y*(f/(2*S)),M=Math.atan2(t.y-L,t.x-p),$=Math.atan2(n.y-L,n.x-p);return{cx:p,cy:L,r:s,startAngle:M,endAngle:$}}function yc(t,n,s){return Is(t,n,s)}function xc(t,n){return{x:t.x,y:t.y}}function gc(t,n){return"r"in t?{cx:n.x,cy:n.y,r:t.r}:{x:n.x-t.width/2,y:n.y-t.height/2,width:t.width,height:t.height}}function pc(t,n,s){const o=Ks(n,s);return{cx:o.x,cy:o.y,r:t.r}}function mc(t,n,s){const o=ve(n,s);return{cx:o.x,cy:o.y,r:t.r}}function Sc(t,n){if("r"in n&&!("startAngle"in n))return{cx:t.cx,cy:t.cy,r:n.r};const s=n;return{cx:t.cx,cy:t.cy,r:s.r,startAngle:s.startAngle,endAngle:s.endAngle}}function Cc(t,n){et(t);const s=_t(n),o={x:(n.from.x+n.to.x)/2,y:(n.from.y+n.to.y)/2},c=t.from.x,a=t.from.y,f=t.to.x-c,h=t.to.y-a,S=Math.sqrt(f*f+h*h);if(S===0)return n;const y=((o.x-c)*f+(o.y-a)*h)/(S*S),g=c+y*f,p=a+y*h,L=s/2,M=f/S,$=h/S;return{from:{x:g-L*M,y:p-L*$},to:{x:g+L*M,y:p+L*$}}}function bc(t,n,s){const o=et(t),c=_t(n),a={x:(n.from.x+n.to.x)/2,y:(n.from.y+n.to.y)/2};if(s!==void 0){const h=o+Math.PI/2;a.x+=s*Math.cos(h),a.y+=s*Math.sin(h)}const f=c/2;return{from:{x:a.x-f*Math.cos(o),y:a.y-f*Math.sin(o)},to:{x:a.x+f*Math.cos(o),y:a.y+f*Math.sin(o)}}}function Lc(t,n,s){const o=et(t),c=s/2;return{from:{x:n.x-c*Math.cos(o),y:n.y-c*Math.sin(o)},to:{x:n.x+c*Math.cos(o),y:n.y+c*Math.sin(o)}}}function Mc(t,n){const s=et(t)+Math.PI/2,o=_t(n),c={x:(n.from.x+n.to.x)/2,y:(n.from.y+n.to.y)/2},a=o/2;return{from:{x:c.x-a*Math.cos(s),y:c.y-a*Math.sin(s)},to:{x:c.x+a*Math.cos(s),y:c.y+a*Math.sin(s)}}}function to(t,n,s){const o=et(t)+Math.PI/2,c=s/2;return{from:{x:n.x-c*Math.cos(o),y:n.y-c*Math.sin(o)},to:{x:n.x+c*Math.cos(o),y:n.y+c*Math.sin(o)}}}function wc(t,n,s){const o=t.from.x+n*(t.to.x-t.from.x),c=t.from.y+n*(t.to.y-t.from.y);return to(t,{x:o,y:c},s)}function Tc(t){const n=(t.from.y+t.to.y)/2;return{from:{x:t.from.x,y:n},to:{x:t.to.x,y:n}}}function $c(t){const n=(t.from.x+t.to.x)/2;return{from:{x:n,y:t.from.y},to:{x:n,y:t.to.y}}}function jc(t,n){return Math.abs(n.x-t.x)}function Rc(t,n){return Math.abs(n.y-t.y)}function vc(t,n){if("from"in t){const c=t;return{x:(c.from.x+c.to.x)/2,y:(c.from.y+c.to.y)/2}}const s=t,o=n;return{x:(s.x+o.x)/2,y:(s.y+o.y)/2}}function Ec(t,n){const s=n.to.x-n.from.x,o=n.to.y-n.from.y,c=s*s+o*o;if(c===0)return{x:n.from.x,y:n.from.y};const a=Math.max(0,Math.min(1,((t.x-n.from.x)*s+(t.y-n.from.y)*o)/c));return{x:n.from.x+a*s,y:n.from.y+a*o}}function Ac(t,n){const s=t.x-n.cx,o=t.y-n.cy,c=Math.sqrt(s*s+o*o);return c===0?{x:n.cx+n.r,y:n.cy}:{x:n.cx+s/c*n.r,y:n.cy+o/c*n.r}}function Pc(t,n){return{x:t.from.x+n*(t.to.x-t.from.x),y:t.from.y+n*(t.to.y-t.from.y)}}function Vc(t,n){return{x:t.cx+t.r*Math.cos(n),y:t.cy+t.r*Math.sin(n)}}function kc(t,n){const s=t.startAngle+n*(t.endAngle-t.startAngle);return{x:t.cx+t.r*Math.cos(s),y:t.cy+t.r*Math.sin(s)}}function zc(t,n){return et(n)-et(t)}function Fc(t,n,s){const o=et(t)+s,c=_t(n),a={x:(n.from.x+n.to.x)/2,y:(n.from.y+n.to.y)/2},f=c/2;return{from:{x:a.x-f*Math.cos(o),y:a.y-f*Math.sin(o)},to:{x:a.x+f*Math.cos(o),y:a.y+f*Math.sin(o)}}}function Zt(t,n){const s=n.to.x-n.from.x,o=n.to.y-n.from.y,c=s*s+o*o;if(c===0)return t;const a=((t.x-n.from.x)*s+(t.y-n.from.y)*o)/c,f=n.from.x+a*s,h=n.from.y+a*o;return{x:2*f-t.x,y:2*h-t.y}}function Dc(t,n){return Zt(t,n)}function Nc(t,n){return{from:Zt(t.from,n),to:Zt(t.to,n)}}function Bc(t,n){const s=Zt({x:t.cx,y:t.cy},n);return{cx:s.x,cy:s.y,r:t.r}}function Hc(t,n){const s=Zt({x:t.x,y:t.y},n),o=Zt({x:t.x+t.width,y:t.y+t.height},n),c=Math.min(s.x,o.x),a=Math.min(s.y,o.y);return{x:c,y:a,width:Math.abs(o.x-s.x),height:Math.abs(o.y-s.y)}}function _c(t,n){return{x:2*n.x-t.x,y:2*n.y-t.y}}function Gc(t){const n=t.cx+t.r*Math.cos(t.startAngle),s=t.cy+t.r*Math.sin(t.startAngle),o=t.cx+t.r*Math.cos(t.endAngle),c=t.cy+t.r*Math.sin(t.endAngle);let a=t.endAngle-t.startAngle;a<0&&(a+=2*Math.PI);const f=a>Math.PI?1:0;return`M ${n} ${s} A ${t.r} ${t.r} 0 ${f} 1 ${o} ${c}`}function Wc(t){return`M ${t.from.x} ${t.from.y} L ${t.to.x} ${t.to.y}`}function Uc(t,n){const s=n??0;if(s<=0)return`M ${t.x} ${t.y} h ${t.width} v ${t.height} h ${-t.width} Z`;const o=Math.min(s,t.width/2,t.height/2),c=t.x,a=t.y,f=t.width,h=t.height;return[`M ${c+o} ${a}`,`H ${c+f-o}`,`A ${o} ${o} 0 0 1 ${c+f} ${a+o}`,`V ${a+h-o}`,`A ${o} ${o} 0 0 1 ${c+f-o} ${a+h}`,`H ${c+o}`,`A ${o} ${o} 0 0 1 ${c} ${a+h-o}`,`V ${a+o}`,`A ${o} ${o} 0 0 1 ${c+o} ${a}`,"Z"].join(" ")}function Oc(t){const{cx:n,cy:s,r:o}=t;return[`M ${n-o} ${s}`,`A ${o} ${o} 0 1 0 ${n+o} ${s}`,`A ${o} ${o} 0 1 0 ${n-o} ${s}`,"Z"].join(" ")}function qc(t,n=!1){if(t.length===0)return"";const s=[`M ${t[0].x} ${t[0].y}`];for(let o=1;o<t.length;o++)s.push(`L ${t[o].x} ${t[o].y}`);return n&&s.push("Z"),s.join(" ")}function Jc({reference:t,children:n}){const s="width"in t?te(t):ne(t);return d.jsx("g",{transform:`translate(${s.x}, ${s.y})`,children:n})}function Xc({reference:t,children:n}){const s="width"in t?te(t):ne(t);return d.jsx("g",{transform:`translate(${s.x}, ${s.y})`,children:n})}function Yc({count:t,along:n,itemSize:s,children:o}){if(t<=0)return null;const a=(_t(n)-t*s)/(t+1),f=et(n),h=Math.cos(f),S=Math.sin(f);return d.jsx(d.Fragment,{children:Array.from({length:t},(y,g)=>{const p=a+g*(s+a)+s/2,L={x:n.from.x+p*h,y:n.from.y+p*S};return d.jsx(Yt.Fragment,{children:o(L,g)},g)})})}function Kc({rect:t,inset:n,children:s}){const o=Qs(t,n);return d.jsx(d.Fragment,{children:s(o)})}function Zc({axis:t,children:n}){const s=(t.from.x+t.to.x)/2,o=(t.from.y+t.to.y)/2,a=et(t)*180/Math.PI;return d.jsxs("g",{children:[n,d.jsx("g",{transform:`translate(${s}, ${o}) rotate(${a}) scale(1, -1) rotate(${-a}) translate(${-s}, ${-o})`,children:n})]})}function Qc({cols:t,rows:n,cellWidth:s,cellHeight:o,gap:c,children:a}){return d.jsx(d.Fragment,{children:Array.from({length:n},(f,h)=>Array.from({length:t},(S,y)=>{const g={x:y*(s+c),y:h*(o+c)};return d.jsx(Yt.Fragment,{children:a(g,y,h)},`${y}-${h}`)}))})}const Ic=Object.freeze(Object.defineProperty({__proto__:null,AlignCenter:Jc,Concentric:Xc,Distribute:Yc,Grid:Qc,Inset:Kc,Mirror:Zc,alignCenterX:ec,alignCenterY:sc,alignEdge:oc,alignFlush:rc,angleBetween:zc,arcBetween:dc,arcInCorner:hc,arcTangentToLines:Is,arcToSVGPath:Gc,centerAtCorner:pc,centerAtEdgeMidpoint:mc,centerAtPoint:gc,circleBoundingBox:Yr,circleCenter:ne,circleCircleIntersection:tc,circleToSVGPath:Oc,coincident:xc,collinear:Cc,concentric:Sc,distanceBetween:ee,distancePointToCircle:Qr,distancePointToLine:Zr,distributeAlongEdge:cc,distributeEvenly:Zs,distributeOnCircle:ac,filletArc:yc,gridPositions:ic,horizontal:Tc,horizontalDistance:jc,insetRect:Qs,lineAngle:et,lineCircleIntersection:Ir,lineDirection:Kr,lineLength:_t,lineLineIntersection:Ee,lineRectIntersection:nc,lineToSVGPath:Wc,midpoint:vc,mirrorCircle:Bc,mirrorLine:Nc,mirrorPoint:Dc,mirrorPointAbout:_c,mirrorRect:Hc,nearestPointOnCircle:Ac,nearestPointOnLine:Ec,offsetCircle:uc,offsetPoint:lc,parallel:bc,parallelLine:fc,parallelThrough:Lc,pathFromPoints:qc,perpendicular:Mc,perpendicularAt:wc,perpendicularThrough:to,pointOnArcAt:kc,pointOnCircleAt:Vc,pointOnLineAt:Pc,rectCenter:te,rectCorner:Ks,rectEdge:hn,rectEdgeMidpoint:ve,rectToSVGPath:Uc,rotateToAngle:Fc,vertical:$c,verticalDistance:Rc},Symbol.toStringTag,{value:"Module"}));let Hn=null;function ti(){return Hn||(Hn=(async()=>{const t=performance.now();try{const n=await Bo({locateFile:()=>Ho});return _o(n),{ok:!0,ms:performance.now()-t}}catch(n){const s=n instanceof Error?n.message:String(n);return{ok:!1,ms:performance.now()-t,error:s}}})(),Hn)}class no{errors=[];report(n){this.errors.push(n)}hasErrors(){return this.errors.length>0}getErrors(){return[...this.errors]}clear(){this.errors=[]}}const ni=O.createContext(new no);class ei extends Yt.Component{constructor(n){super(n),this.state={hasError:!1,message:"",componentStack:""}}static getDerivedStateFromError(n){return{hasError:!0,message:n.message,componentStack:n.stack??""}}componentDidCatch(n,s){this.props.collector.report({kind:"render",message:n.message,componentStack:s.componentStack??""})}render(){return this.state.hasError?d.jsxs("div",{style:{padding:12,color:"#be185d",fontSize:12},children:[d.jsx("strong",{children:"Render error:"})," ",this.state.message]}):this.props.children}}const R={app:{fontFamily:"system-ui, -apple-system, Segoe UI, sans-serif",color:"#1f2933",background:"#f5f7fa",minHeight:"100vh"},header:{padding:"16px 24px 8px",display:"flex",alignItems:"baseline",gap:16},title:{margin:0,fontSize:22},subtitle:{margin:0,fontSize:13,color:"#52606d"},main:{display:"grid",gridTemplateColumns:"minmax(280px, 420px) minmax(360px, 1fr)",gap:16,padding:"12px 24px 24px"},panel:{background:"#fff",borderRadius:10,border:"1px solid #e4e7eb",padding:16,minHeight:520,display:"flex",flexDirection:"column"},panelHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},panelTitle:{margin:0,fontSize:13,textTransform:"uppercase",letterSpacing:1,color:"#52606d"},editor:{width:"100%",maxWidth:420,flex:1,border:"1px solid #cbd2d9",borderRadius:8,padding:12,fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, monospace",fontSize:12.5,lineHeight:1.6,background:"#f8f9fa",color:"#102a43",boxSizing:"border-box"},actions:{display:"flex",gap:8,marginTop:10},button:{border:"1px solid #1f2933",background:"#1f2933",color:"#fff",padding:"6px 12px",borderRadius:6,fontSize:12,cursor:"pointer"},buttonSecondary:{border:"1px solid #1f2933",background:"#e4e7eb",color:"#1f2933",padding:"6px 12px",borderRadius:6,fontSize:12,cursor:"pointer"},buttonGhost:{border:"1px solid #cbd2d9",background:"#fff",color:"#1f2933",padding:"6px 12px",borderRadius:6,fontSize:12,cursor:"pointer"},viewport:{flex:1,border:"1px dashed #cbd2d9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",background:"#fdfdfc",padding:8},tabs:{display:"flex",gap:8},tabButton:{border:"1px solid #cbd2d9",background:"#f8f9fa",color:"#1f2933",padding:"4px 10px",borderRadius:999,fontSize:12,cursor:"pointer"},tabButtonActive:{border:"1px solid #1f2933",background:"#1f2933",color:"#fff"},source:{width:"100%",height:"100%",padding:12,borderRadius:8,background:"#0b1215",color:"#e5e7eb",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, monospace",fontSize:12,overflow:"auto",whiteSpace:"pre"},errorPanel:{marginTop:10,padding:10,borderRadius:8,border:"1px solid #fecaca",background:"#fff5f5",color:"#7f1d1d",fontSize:12,whiteSpace:"pre-wrap"},errorBadge:{display:"inline-block",padding:"1px 6px",borderRadius:4,fontSize:10,fontWeight:700,textTransform:"uppercase",marginRight:6},diagnostics:{marginTop:12,padding:12,borderRadius:10,border:"1px solid #e4e7eb",background:"#f8fafc",fontSize:12,color:"#334e68"},diagTitle:{margin:"0 0 8px",fontSize:12,color:"#52606d",textTransform:"uppercase",letterSpacing:1},diagRow:{display:"flex",justifyContent:"space-between",gap:8,padding:"2px 0"}},cn=`// trammel claude demo
const vars = {
  panelWidth: 300,
  panelHeight: 100,
  cornerRadius: 15,
  mountHoleRadius: 5,
  mountHoleInset: 12,
  knobCount: 4,
  knobSize: 20,
  panelColor: '#e2e8f0',
  holeColor: '#333',
  knobColor: '#3b82f6',
};

const panel: Rect = { x: 0, y: 0, width: vars.panelWidth, height: vars.panelHeight };
const inner = insetRect(panel, vars.mountHoleInset);

const mountPositions = [
  rectCorner(inner, 'topLeft'),
  rectCorner(inner, 'topRight'),
  rectCorner(inner, 'bottomLeft'),
  rectCorner(inner, 'bottomRight'),
];

const cornerArc = arcInCorner(vars.cornerRadius, panel, 'topLeft');
const knobXPositions = distributeEvenly(vars.knobCount, vars.knobSize, vars.panelWidth);

const MountHole = ({ pos }: { pos: Point }) => (
  <circle cx={pos.x} cy={pos.y} r={vars.mountHoleRadius} fill={vars.holeColor} />
);

const Knob = ({ x }: { x: number }) => (
  <rect
    x={x}
    y={-vars.knobSize}
    width={vars.knobSize}
    height={vars.knobSize}
    rx={3}
    fill={vars.knobColor}
    stroke="#1e40af"
    strokeWidth={1.5}
  />
);

const Root = () => (
  <svg viewBox={\`-10 -\${vars.knobSize + 10} \${vars.panelWidth + 20} \${vars.panelHeight + vars.knobSize + 20}\`}>
    <rect
      x={panel.x} y={panel.y}
      width={panel.width} height={panel.height}
      rx={vars.cornerRadius}
      fill={vars.panelColor}
      stroke="#0f172a"
      strokeWidth={2}
    />
    <path d={arcToSVGPath(cornerArc)} fill="none" stroke="#0f172a" strokeWidth={1} />
    {mountPositions.map((pos, i) => <MountHole key={i} pos={pos} />)}
    {knobXPositions.map((x, i) => <Knob key={i} x={x} />)}
  </svg>
);
`;function si(t){try{const s=new DOMParser().parseFromString(t,"image/svg+xml").documentElement,o=[],c=(a,f)=>{const h="  ".repeat(f),S=Array.from(a.attributes).map(g=>` ${g.name}="${g.value}"`).join(""),y=Array.from(a.children);if(y.length===0){o.push(`${h}<${a.tagName}${S} />`);return}o.push(`${h}<${a.tagName}${S}>`),y.forEach(g=>c(g,f+1)),o.push(`${h}</${a.tagName}>`)};return c(s,0),o.join(`
`)}catch{return t}}function Ft(t,n,s){s.clear();const o=performance.now();let c;try{c=Go(t,{transforms:["typescript","jsx"]}).code}catch(a){const f=a instanceof Error?a.message:String(a);return s.report({kind:"syntax",message:f,line:0,column:0,source:t.slice(0,200)}),{element:null,error:f,vars:{},evalMs:performance.now()-o,collectedErrors:s.getErrors()}}try{const a=`
      const { useMemo, useState, useEffect, useRef } = React;
      const {
        rectCenter, rectCorner, rectEdgeMidpoint, rectEdge,
        circleCenter, circleBoundingBox,
        lineLength, lineAngle, lineDirection,
        distanceBetween, distancePointToLine, distancePointToCircle,
        lineLineIntersection, lineCircleIntersection, circleCircleIntersection, lineRectIntersection,
        alignCenterX, alignCenterY, alignEdge, alignFlush,
        distributeEvenly, distributeAlongEdge, gridPositions, distributeOnCircle,
        offsetPoint, parallelLine, insetRect, offsetCircle,
        arcTangentToLines, arcInCorner, arcBetween, filletArc,
        coincident, centerAtPoint, centerAtCorner, centerAtEdgeMidpoint,
        concentric, collinear,
        parallel, parallelThrough, perpendicular, perpendicularThrough, perpendicularAt,
        horizontal, vertical, horizontalDistance, verticalDistance,
        midpoint, nearestPointOnLine, nearestPointOnCircle,
        pointOnLineAt, pointOnCircleAt, pointOnArcAt,
        angleBetween, rotateToAngle,
        mirrorPoint, mirrorLine, mirrorCircle, mirrorRect, mirrorPointAbout,
        arcToSVGPath, lineToSVGPath, rectToSVGPath, circleToSVGPath, pathFromPoints,
      } = constraints;
      const draw = replicad.draw;
      ${c}
      if (typeof vars === 'object' && vars !== null) {
        Object.assign(vars, overrides ?? {});
      }
      const rootValue = typeof Root !== 'undefined' ? Root : null;
      const element = React.isValidElement(rootValue)
        ? rootValue
        : typeof rootValue === 'function'
          ? React.createElement(rootValue)
          : null;
      const capturedVars = typeof vars === 'object' && vars !== null ? vars : {};
      return { element, vars: capturedVars };
    `,h=new Function("React","constraints","replicad","overrides","errorCollector",a)(Yt,Ic,{draw:Wo},n,s),S=performance.now()-o;return{element:h.element,vars:h.vars,error:null,evalMs:S,collectedErrors:s.getErrors()}}catch(a){const f=a instanceof Error?a.message:String(a),h=a instanceof Error&&a.stack?a.stack:"";return s.report({kind:"eval",message:f,stack:h}),{element:null,vars:{},error:`${f}
${h}`,evalMs:performance.now()-o,collectedErrors:s.getErrors()}}}const oi={syntax:"#dc2626",eval:"#ea580c",constraint:"#d97706",geometry:"#7c3aed",variable:"#0891b2",render:"#be185d"};function ri(){const t=O.useMemo(()=>Jr(),[]),n=O.useMemo(()=>Xr(t),[t]),s=O.useMemo(()=>new no,[]),[o,c]=O.useState(cn),[a,f]=O.useState({}),[h,S]=O.useState(()=>Ft(cn,{},s)),[y,g]=O.useState("visual"),[p,L]=O.useState(""),[M,$]=O.useState({nodes:0,bytes:0}),[F,_]=O.useState(0),[J,ot]=O.useState({state:"idle",ms:0}),pt=Yt.useRef(null),Mt=Yt.useRef(null),ht=()=>S(Ft(o,a,s)),dt=()=>{c(cn),f({}),S(Ft(cn,{},s))},A=()=>{const b=new Blob([o],{type:"text/plain"}),E=URL.createObjectURL(b),P=document.createElement("a");P.href=E,P.download="trammel-claude.tsx",P.click(),URL.revokeObjectURL(E)},G=()=>{if(!p)return;const b=new Blob([p],{type:"image/svg+xml"}),E=URL.createObjectURL(b),P=document.createElement("a");P.href=E,P.download="trammel-claude.svg",P.click(),URL.revokeObjectURL(E)},rt=async b=>{const E=b.target.files?.[0];if(!E)return;const P=await E.text();c(P),f({}),S(Ft(P,{},s)),b.target.value=""},wt=b=>{(b.ctrlKey||b.metaKey)&&b.key==="Enter"&&(b.preventDefault(),ht())},yt=O.useMemo(()=>h.element,[h.element]);O.useEffect(()=>{let b=!1;return(async()=>{await n.startAutoLoad();const P=t.getCell("files","default","content");!b&&typeof P=="string"&&P.length>0?(c(P),S(Ft(P,a,s))):b||t.setRow("files","default",{name:"main.tsx",content:cn}),n.startAutoSave()})(),()=>{b=!0,n.stopAutoSave()}},[n,t]),O.useEffect(()=>{t.setRow("files","default",{name:"main.tsx",content:o})},[o,t]),O.useEffect(()=>{const b=pt.current;if(!b)return;const E=b.querySelector("svg");if(!E){L(""),$({nodes:0,bytes:0});return}const P=performance.now(),Z=new XMLSerializer().serializeToString(E);L(si(Z)),_(performance.now()-P),$({nodes:E.querySelectorAll("*").length+1,bytes:Z.length})},[yt,h.error]),O.useEffect(()=>{let b=!0;return ot({state:"loading",ms:0}),ti().then(E=>{b&&(E.ok?ot({state:"ready",ms:E.ms}):ot({state:"error",ms:E.ms,error:E.error}))}),()=>{b=!1}},[]);const at=Object.entries(h.vars??{}),K=h.collectedErrors;return d.jsx(ni.Provider,{value:s,children:d.jsxs("div",{style:R.app,children:[d.jsxs("header",{style:R.header,children:[d.jsx("h1",{style:R.title,children:"trammel claude"}),d.jsx("p",{style:R.subtitle,children:"Parametric art tool — editor + SVG viewport"})]}),d.jsxs("main",{style:R.main,children:[d.jsxs("section",{style:R.panel,children:[d.jsxs("div",{style:R.panelHeader,children:[d.jsx("h2",{style:R.panelTitle,children:"Editor"}),K.length>0&&d.jsxs("span",{style:{fontSize:11,color:"#b91c1c"},children:[K.length," error",K.length>1?"s":""]})]}),d.jsx("textarea",{style:R.editor,value:o,onChange:b=>c(b.target.value),onKeyDown:wt}),d.jsxs("div",{style:R.actions,children:[d.jsx("button",{style:R.button,type:"button",onClick:ht,children:"Run (Ctrl+Enter)"}),d.jsx("button",{style:R.buttonSecondary,type:"button",onClick:dt,children:"Reset Demo"}),d.jsx("button",{style:R.buttonGhost,type:"button",onClick:()=>Mt.current?.click(),children:"Import .tsx"}),d.jsx("button",{style:R.buttonGhost,type:"button",onClick:A,children:"Export .tsx"}),d.jsx("button",{style:R.buttonGhost,type:"button",onClick:G,disabled:!p,children:"Export .svg"})]}),d.jsx("input",{ref:Mt,type:"file",accept:".tsx,.ts,.txt",style:{display:"none"},onChange:rt}),at.length>0&&d.jsxs("div",{style:{marginTop:16},children:[d.jsx("h3",{style:{margin:"0 0 8px",fontSize:12,color:"#52606d"},children:"Variables"}),d.jsx("div",{style:{display:"grid",gap:6},children:at.map(([b,E])=>{const P=`var-${b}`,Z=typeof E,xt=Z==="string"&&String(E).startsWith("#")?"color":Z==="number"?"number":Z==="boolean"?"checkbox":"text";return d.jsxs("label",{htmlFor:P,style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("span",{style:{fontSize:12,color:"#52606d",minWidth:100},children:b}),xt==="checkbox"?d.jsx("input",{id:P,type:"checkbox",checked:!!(a[b]??E),onChange:ft=>{const ct={...a,[b]:ft.target.checked};f(ct),S(Ft(o,ct,s))}}):d.jsx("input",{id:P,type:xt,value:String(a[b]??E),onChange:ft=>{const ct=xt==="number"?Number(ft.target.value):ft.target.value,mt={...a,[b]:ct};f(mt),S(Ft(o,mt,s))},style:{flex:1,border:"1px solid #cbd2d9",borderRadius:6,padding:"4px 8px",fontSize:12}})]},b)})})]})]}),d.jsxs("section",{style:R.panel,children:[d.jsxs("div",{style:R.panelHeader,children:[d.jsx("h2",{style:R.panelTitle,children:"Viewport"}),d.jsxs("div",{style:R.tabs,children:[d.jsx("button",{type:"button",onClick:()=>g("visual"),style:{...R.tabButton,...y==="visual"?R.tabButtonActive:{}},children:"Visual"}),d.jsx("button",{type:"button",onClick:()=>g("source"),style:{...R.tabButton,...y==="source"?R.tabButtonActive:{}},children:"Source"})]})]}),d.jsx("div",{style:R.viewport,ref:pt,children:d.jsx(ei,{collector:s,children:y==="visual"?yt??d.jsx("span",{style:{color:"#94a3b8"},children:"No SVG rendered."}):d.jsx("pre",{style:R.source,children:p||"No SVG rendered yet."})})}),K.length>0&&d.jsxs("div",{style:R.errorPanel,children:[d.jsxs("strong",{children:["Errors (",K.length,")"]}),K.map((b,E)=>d.jsxs("div",{style:{marginTop:6},children:[d.jsx("span",{style:{...R.errorBadge,background:oi[b.kind]??"#666",color:"#fff"},children:b.kind}),d.jsx("span",{children:b.message}),"suggestion"in b&&b.suggestion&&d.jsxs("div",{style:{marginTop:2,color:"#4a5568",fontSize:11},children:["Suggestion: ",b.suggestion]})]},E))]}),d.jsxs("div",{style:R.diagnostics,children:[d.jsx("h3",{style:R.diagTitle,children:"Diagnostics"}),d.jsxs("div",{style:R.diagRow,children:[d.jsx("span",{children:"Eval time"}),d.jsxs("span",{children:[h.evalMs.toFixed(1)," ms"]})]}),d.jsxs("div",{style:R.diagRow,children:[d.jsx("span",{children:"Serialize time"}),d.jsxs("span",{children:[F.toFixed(1)," ms"]})]}),d.jsxs("div",{style:R.diagRow,children:[d.jsx("span",{children:"SVG nodes"}),d.jsx("span",{children:M.nodes})]}),d.jsxs("div",{style:R.diagRow,children:[d.jsx("span",{children:"SVG size"}),d.jsxs("span",{children:[(M.bytes/1024).toFixed(1)," KB"]})]}),d.jsxs("div",{style:R.diagRow,children:[d.jsx("span",{children:"Replicad"}),d.jsx("span",{children:J.state==="ready"?`Ready (${J.ms.toFixed(1)} ms)`:J.state==="loading"?"Loading...":J.state==="error"?`Error: ${J.error}`:"Idle"})]})]})]})]})]})})}function bi(){return d.jsx(ri,{})}export{bi as default};
