import{r as J,R as Pt,j as f}from"./index-DVz0_quL.js";import{M as Ro,o as vo,s as wo,t as jo,d as Eo}from"./replicad_single-CHjvLvIh.js";const Ge=t=>typeof t,Qe="",Vo=Ge(Qe),$o=Ge(!0),vn=Ge(0),zo=Ge(Ge),jt="type",Re="default",Et="allowNull",Fo="null",No="Listener",ko="add",Ae="Has",qt="Ids",Xe="Table",gn=Xe+"s",Do=Xe+qt,At="Row",Po=At+"Count",Mo=At+qt,Mt="Cell",hn=Mt+qt,Ut="Value",pn=Ut+"s",Ao=Ut+qt,N=t=>Qe+t,wn=t=>(s,r,a)=>t(s)?a?.():r(s),Uo=isFinite,_o=(t,s)=>t instanceof s,_t=t=>t==null,I=t=>t===void 0,We=t=>t===null,Bo=wn(_t),K=wn(I),jn=t=>t==Vo||t==$o,ss=t=>Ge(t)==zo,En=t=>Array.isArray(t),yn=(t,s,r)=>t.slice(s,r),ve=t=>t.length,Wo=(t,s)=>t.test(s),ns=async(t,s,r)=>{try{return await t()}catch(a){s?.(a)}},Go=(t,s)=>t.includes(s),Ho=(t,s)=>t.every(s),Jo=(t,s)=>ve(t)===ve(s)&&Ho(t,(r,a)=>s[a]===r),Oo=(t,s)=>t.sort(s),at=(t,s)=>t.forEach(s),Bt=(t,s)=>t.map(s),qo=(t,s,r)=>t.reduce(s,r),Wt=(t,...s)=>t.push(...s),Ko=t=>t.shift(),tt=t=>{if(We(t))return Fo;const s=Ge(t);return jn(s)||s==vn&&Uo(t)?s:void 0},xn=(t,s,r,a,l)=>I(l)?t.delCell(s,r,a,!0):t.setCell(s,r,a,l),bn=(t,s,r)=>I(r)?t.delValue(s):t.setValue(s,r),xs=t=>s=>qo(Yo(s),(r,a)=>r+t(a),0),bs=t=>t?.size??0,Ss=xs(bs),ot=xs(Ss),os=xs(ot),Z=(t,s)=>t?.has(s)??!1,L=t=>I(t)||bs(t)==0,Yo=t=>[...t?.values()??[]],rs=t=>t.clear(),w=(t,s)=>t?.forEach(s),Gt=(t,s)=>t?.delete(s),Pe=Object,Sn=t=>Pe.getPrototypeOf(t),Xo=Pe.isFrozen,Vn=Pe.entries,Ht=t=>!_t(t)&&Bo(Sn(t),s=>s==Pe.prototype||_t(Sn(s)),()=>!0),Qo=Pe.keys,Zo=Pe.freeze,Io=(t=[])=>Pe.fromEntries(t),rt=(t,s)=>s in t,$n=(t,s)=>(delete t[s],t),er=(t,s)=>at(Vn(t),([r,a])=>s(a,r)),tr=(t,s)=>Bt(Vn(t),([r,a])=>s(a,r)),Fe=(t,s)=>Io(tr(t,(r,a)=>[a,s(r,a)])),sr=t=>ve(Qo(t)),be=t=>Ht(t)&&sr(t)==0,ze=(t,s,r,a=0)=>_t(t)||!Ht(t)||!a&&be(t)||Xo(t)?(r?.(),!1):(er(t,(l,u)=>{s(l,u)||$n(t,u)}),a?!0:!be(t)),T=t=>new Map(t),st=t=>[...t?.keys()??[]],g=(t,s)=>t?.get(s),Ne=(t,s)=>w(t,(r,a)=>s(a,r)),nr=(t,s)=>Bt([...t?.entries()??[]],([r,a])=>s(a,r)),D=(t,s,r)=>I(r)?(Gt(t,s),t):t?.set(s,r),X=(t,s,r,a)=>(Z(t,s)?a?.(g(t,s)):D(t,s,r()),g(t,s)),Ue=(t,s,r,a=D)=>(Fe(s,(l,u)=>r(t,u,l)),Ne(t,l=>rt(s,l)?0:a(t,l)),t),se=(t,s,r,a)=>{const l={};return w(t,(u,p)=>{if(!r?.(u,p)){const P=s?s(u,p):u;a?.(P)||(l[p]=P)}}),l},as=(t,s,r)=>se(t,a=>se(a,s,r),L,be),Vt=(t,s,r)=>se(t,a=>as(a,s,r),L,be),ke=(t,s)=>{const r=T();return w(t,(a,l)=>r.set(l,s?.(a)??a)),r},ls=t=>ke(t,ke),is=t=>ke(t,ls),ds=(t,s,r,a,l=0)=>K((r?X:g)(t,s[l],l>ve(s)-2?r:T),u=>{if(l>ve(s)-2)return a?.(u)&&D(t,s[l]),u;const p=ds(u,s,r,a,l+1);return L(u)&&D(t,s[l]),p}),it=t=>new Set(En(t)||I(t)?t:[t]),ct=(t,s)=>t?.add(s),or=/^\d+$/,zn=()=>{const t=[];let s=0;return[r=>(r?Ko(t):null)??Qe+s++,r=>{Wo(or,r)&&ve(t)<1e3&&Wt(t,r)}]},rr=(t,s=[Qe])=>{const r=[],a=(l,u)=>u==ve(s)?Wt(r,l):We(s[u])?w(l,p=>a(p,u+1)):at([s[u],null],p=>a(g(l,p),u+1));return a(t,0),r},ir=t=>{let s;const[r,a]=zn(),l=T();return[(x,b,S,F=[],j=()=>[])=>{s??=t();const E=r(1);return D(l,E,[x,b,S,F,j]),ct(ds(b,S??[Qe],it),E),E},(x,b,...S)=>at(rr(x,b),F=>w(F,j=>g(l,j)[0](s,...b??[],...S))),x=>K(g(l,x),([,b,S])=>(ds(b,S??[Qe],void 0,F=>(Gt(F,x),L(F)?1:0)),D(l,x),a(x),S)),x=>K(g(l,x),([b,,S=[],F,j])=>{const E=(...k)=>{const A=ve(k);A==ve(S)?b(s,...k,...j(k)):We(S[A])?at(F[A]?.(...k)??[],G=>E(...k,G)):E(...k,S[A])};E()})]},cr=JSON.stringify,cs=JSON.parse,Ke=t=>cr(t,(s,r)=>_o(r,Map)?Pe.fromEntries([...r]):r),ar=(t,s)=>(t??0)<(s??0)?-1:1,$t=t=>[t,t],_=(t,s=Ss)=>s(t[0])+s(t[1]),B=()=>[T(),T()],mn=t=>[...t],zt=([t,s])=>t===s,nt=(t,s,r)=>D(t,s,g(t,s)==-r?void 0:r),Fn=()=>{let t,s,r=!1,a=!1,l=0,u=[];const p=T(),P=T(),M=T(),x=T(),b=T(),S=T(),F=T(),j=T(),E=T(),k=T(),A=T(),G=T(),ie=T(),ce=T(),le=it(),ue=T(),Y=T(),v=T(),W=T(),ne=B(),Se=B(),ge=B(),he=B(),pe=B(),de=B(),we=B(),ye=B(),xe=B(),ee=B(),me=B(),je=B(),y=B(),C=B(),V=B(),H=B(),oe=B(),Ce=B(),Ee=B(),Me=B(),O=B(),R=B(),te=T(),ae=B(),[Ve,q,Bn,Wn]=ir(()=>Q),Gn=e=>ze(e,n=>ze(n,Cs)),Hn=e=>ze(e,Cs),Cs=e=>{if(!ze(e,(i,c)=>Go([jt,Re,Et],c)))return!1;const n=e[jt];if(!jn(n)&&n!=vn)return!1;const o=e[Re];return We(o)&&!e[Et]?!1:(!We(o)&&tt(o)!=n&&$n(e,Re),!0)},Jn=En,On=e=>ze(e,Ls,Le),Ls=(e,n)=>(!t||Z(A,n)||Le(n))&&ze(e,(o,i)=>ft(n,i,o),()=>Le(n)),ft=(e,n,o,i)=>ze(i?o:ws(o,e,n),(c,d)=>K(Ts(e,n,d,c),h=>(o[d]=h,!0),()=>!1),()=>Le(e,n)),Ts=(e,n,o,i)=>t?K(g(g(A,e),o),c=>We(i)?c[Et]?i:Le(e,n,o,i,c[Re]):tt(i)==c[jt]?i:Le(e,n,o,i,c[Re]),()=>Le(e,n,o,i)):I(tt(i))?Le(e,n,o,i):i,Rs=(e,n)=>ze(n?e:qn(e),(o,i)=>K(vs(i,o),c=>(e[i]=c,!0),()=>!1),()=>Oe()),vs=(e,n)=>s?K(g(ie,e),o=>We(n)?o[Et]?n:Oe(e,n,o[Re]):tt(n)==o[jt]?n:Oe(e,n,o[Re]),()=>Oe(e,n)):I(tt(n))?Oe(e,n):n,ws=(e,n,o)=>(K(g(G,n),([i,c])=>{w(i,(d,h)=>{rt(e,h)||(e[h]=d)}),w(c,d=>{rt(e,d)||Le(n,o,d)})}),e),qn=e=>(s&&(w(ce,(n,o)=>{rt(e,o)||(e[o]=n)}),w(le,n=>{rt(e,n)||Oe(n)})),e),js=e=>Ue(A,e,(n,o,i)=>{const c=T(),d=it();Ue(X(A,o,T),i,(h,$,z)=>{D(h,$,z),K(z[Re],Te=>D(c,$,Te),()=>ct(d,$))}),D(G,o,[c,d])},(n,o)=>{D(A,o),D(G,o)}),Es=e=>Ue(ie,e,(n,o,i)=>{D(ie,o,i),K(i[Re],c=>D(ce,o,c),()=>ct(le,o))},(n,o)=>{D(ie,o),D(ce,o),Gt(le,o)}),Vs=e=>be(e)?Tt():Ct(e),Kn=([e,n])=>{(be(e)?Tt:Ct)(e),(be(n)?Rt:Lt)(n)},$s=e=>Ue(v,e,(n,o,i)=>ut(o,i),(n,o)=>ks(o)),ut=(e,n)=>Ue(X(v,e,()=>(As(e,1),D(ue,e,zn()),D(Y,e,T()),T())),n,(o,i,c)=>Ze(e,o,i,c),(o,i)=>Ds(e,o,i)),Ze=(e,n,o,i,c)=>Ue(X(n,o,()=>(Us(e,o,1),T())),i,(d,h,$)=>Yt(e,o,d,h,$),(d,h)=>Ps(e,n,o,d,h,c)),Yt=(e,n,o,i,c)=>{Z(o,i)||_s(e,n,i,1);const d=g(o,i);c!==d&&(Bs(e,n,i,d,c),D(o,i,c))},zs=(e,n,o,i,c)=>K(g(n,o),d=>Yt(e,o,d,i,c),()=>Ze(e,n,o,ws({[i]:c},e,o))),Fs=e=>be(e)?Rt():Lt(e),Ns=e=>Ue(W,e,(n,o,i)=>gt(o,i),(n,o)=>Ms(o)),gt=(e,n)=>{Z(W,e)||Ws(e,1);const o=g(W,e);n!==o&&(Gs(e,o,n),D(W,e,n))},Yn=(e,n)=>{const[o]=g(ue,e);let i;do i=o(n);while(Z(g(v,e),i));return i},ht=e=>g(v,e)??ut(e,{}),ks=e=>ut(e,{}),Ds=(e,n,o)=>{const[,i]=g(ue,e);i(o),Ze(e,n,o,{},!0)},Ps=(e,n,o,i,c,d)=>{const h=g(g(G,e)?.[0],c);if(!I(h)&&!d)return Yt(e,o,i,c,h);const $=z=>{Bs(e,o,z,g(i,z)),_s(e,o,z,-1),D(i,z)};I(h)?$(c):Ne(i,$),L(i)&&(Us(e,o,-1),L(D(n,o))&&(As(e,-1),D(v,e),D(ue,e),D(Y,e)))},Ms=e=>{const n=g(ce,e);if(!I(n))return gt(e,n);Gs(e,g(W,e)),Ws(e,-1),D(W,e)},As=(e,n)=>nt(p,e,n),Us=(e,n,o)=>nt(X(x,e,T),n,o)&&D(M,e,X(M,e,()=>0)+o),_s=(e,n,o,i)=>{const c=g(Y,e),d=g(c,o)??0;(d==0&&i==1||d==1&&i==-1)&&nt(X(P,e,T),o,i),D(c,o,d!=-i?d+i:void 0),nt(X(X(b,e,T),n,T),o,i)},Bs=(e,n,o,i,c)=>{X(X(X(S,e,T),n,T),o,()=>[i,0])[1]=c,u[3]?.(e,n,o,c)},Ws=(e,n)=>nt(F,e,n),Gs=(e,n,o)=>{X(j,e,()=>[n,0])[1]=o,u[4]?.(e,o)},Le=(e,n,o,i,c)=>(Wt(X(X(X(E,e,T),n,T),o,()=>[]),i),c),Oe=(e,n,o)=>(Wt(X(k,e,()=>[]),n),o),pt=(e,n,o)=>K(g(g(g(S,e),n),o),([i,c])=>[!0,i,c],()=>[!1,...$t(xt(e,n,o))]),Hs=e=>K(g(j,e),([n,o])=>[!0,n,o],()=>[!1,...$t(bt(e))]),Js=e=>!L(E)&&!L(H[e])?w(e?is(E):E,(n,o)=>w(n,(i,c)=>w(i,(d,h)=>q(H[e],[o,c,h],d)))):0,Os=e=>!L(k)&&!L(oe[e])?w(e?ke(k):k,(n,o)=>q(oe[e],[o],n)):0,Ie=(e,n,o,i)=>{if(!L(e))return q(n,i,()=>se(e)),Ne(e,(c,d)=>q(o,[...i??[],c],d==1)),1},qs=e=>{const n=St();n!=r&&q(ne[e],void 0,n);const o=L(ee[e]),i=L(y[e])&&L(C[e])&&L(xe[e])&&L(me[e])&&L(de[e])&&L(we[e])&&L(ye[e])&&o&&L(ge[e])&&L(he[e]),c=L(V[e])&&L(je[e])&&L(pe[e])&&L(Se[e]);if(!i||!c){const d=e?[ke(p),ls(P),ke(M),ls(x),is(b),is(S)]:[p,P,M,x,b,S];if(!i){Ie(d[0],ge[e],he[e]),w(d[1],($,z)=>Ie($,de[e],we[e],[z])),w(d[2],($,z)=>{$!=0&&q(ye[e],[z],Qs(z))});const h=it();w(d[3],($,z)=>{Ie($,xe[e],me[e],[z])&&!o&&(q(ee[e],[z,null]),ct(h,z))}),o||w(d[5],($,z)=>{if(!Z(h,z)){const Te=it();w($,$e=>w($e,([vt,wt],et)=>wt!==vt?ct(Te,et):Gt($e,et))),w(Te,$e=>q(ee[e],[z,$e]))}}),w(d[4],($,z)=>w($,(Te,$e)=>Ie(Te,y[e],C[e],[z,$e])))}if(!c){let h;w(d[5],($,z)=>{let Te;w($,($e,vt)=>{let wt;w($e,([et,un],To)=>{un!==et&&(q(V[e],[z,vt,To],un,et,pt),h=Te=wt=1)}),wt&&q(je[e],[z,vt],pt)}),Te&&q(pe[e],[z],pt)}),h&&q(Se[e],void 0,pt)}}},Ks=e=>{const n=mt();n!=a&&q(Ce[e],void 0,n);const o=L(Me[e])&&L(O[e]),i=L(R[e])&&L(Ee[e]);if(!o||!i){const c=e?[ke(F),ke(j)]:[F,j];if(o||Ie(c[0],Me[e],O[e]),!i){let d;w(c[1],([h,$],z)=>{$!==h&&(q(R[e],[z],$,h,Hs),d=1)}),d&&q(Ee[e],void 0,Hs)}}},U=(e,...n)=>(ts(()=>e(...Bt(n,N))),Q),Ys=(e,n,o,i,c)=>{let d=yt(e,n,...o);return Ve(()=>{const h=yt(e,n,...o);Jo(h,d)||(d=h,i(Q,e,n,...o,d))},ee[c?1:0],[e,n],[re])},Xn=()=>[Xt(),Zt()],Xt=()=>Vt(v),re=()=>st(v),Qn=e=>as(g(v,N(e))),Xs=e=>st(g(Y,N(e))),Qs=e=>bs(g(v,N(e))),qe=e=>st(g(v,N(e))),yt=(e,n,o,i=0,c)=>Ht(e)?yt(e.tableId,e.cellId,e.descending,e.offset,e.limit):Bt(yn(Oo(nr(g(v,N(e)),(d,h)=>[I(n)?h:g(d,N(n)),h]),([d],[h])=>ar(d,h)*(o?-1:1)),i,I(c)?c:i+c),([,d])=>d),Zn=(e,n)=>se(g(g(v,N(e)),N(n))),Qt=(e,n)=>st(g(g(v,N(e)),N(n))),xt=(e,n,o)=>g(g(g(v,N(e)),N(n)),N(o)),Zt=()=>se(W),It=()=>st(W),bt=e=>g(W,N(e)),St=()=>!L(v),Zs=e=>Z(v,N(e)),Is=(e,n)=>Z(g(Y,N(e)),N(n)),en=(e,n)=>Z(g(v,N(e)),N(n)),tn=(e,n,o)=>Z(g(g(v,N(e)),N(n)),N(o)),mt=()=>!L(W),sn=e=>Z(W,N(e)),In=()=>Ke(v),eo=()=>Ke(W),to=()=>Ke([v,W]),so=()=>Ke(A),no=()=>Ke(ie),oo=()=>Ke([A,ie]),ro=e=>U(()=>{const n=ss(e)?e():e;Jn(n)&&Kn(n)}),Ct=e=>U(()=>On(e)?$s(e):0),io=(e,n)=>U(o=>Ls(n,o)?ut(o,n):0,e),co=(e,n,o)=>U((i,c)=>ft(i,c,o)?Ze(i,ht(i),c,o):0,e,n),ao=(e,n,o=!0)=>ts(()=>{let i;return ft(e,i,n)&&(e=N(e),Ze(e,ht(e),i=Yn(e,o?1:0),n)),i}),lo=(e,n,o)=>U((i,c)=>{if(ft(i,c,o,1)){const d=ht(i);Fe(o,(h,$)=>zs(i,d,c,$,h))}},e,n),fo=(e,n,o,i)=>U((c,d,h)=>K(Ts(c,d,h,ss(i)?i(xt(c,d,h)):i),$=>zs(c,ht(c),d,h,$)),e,n,o),Lt=e=>U(()=>Rs(e)?Ns(e):0),uo=e=>U(()=>Rs(e,1)?Fe(e,(n,o)=>gt(o,n)):0),go=(e,n)=>U(o=>K(vs(o,ss(n)?n(bt(o)):n),i=>gt(o,i)),e),ho=e=>U(()=>{Fe(e[0],(n,o)=>I(n)?cn(o):Fe(n,(i,c)=>I(i)?an(o,c):Fe(i,(d,h)=>xn(Q,o,c,h,d)))),Fe(e[1],(n,o)=>bn(Q,o,n))}),nn=e=>(ns(()=>Vs(cs(e))),Q),po=e=>(ns(()=>Fs(cs(e))),Q),yo=e=>U(()=>ns(()=>{const[n,o]=cs(e);Vs(n),Fs(o)},()=>nn(e))),on=e=>U(()=>{if((t=Gn(e))&&(js(e),!L(v))){const n=Xt();Tt(),Ct(n)}}),rn=e=>U(()=>{if(s=Hn(e)){const n=Zt();es(),Rt(),s=!0,Es(e),Lt(n)}}),xo=(e,n)=>U(()=>{on(e),rn(n)}),Tt=()=>U(()=>$s({})),cn=e=>U(n=>Z(v,n)?ks(n):0,e),an=(e,n)=>U((o,i)=>K(g(v,o),c=>Z(c,i)?Ds(o,c,i):0),e,n),bo=(e,n,o,i)=>U((c,d,h)=>K(g(v,c),$=>K(g($,d),z=>Z(z,h)?Ps(c,$,d,z,h,i):0)),e,n,o),Rt=()=>U(()=>Ns({})),So=e=>U(n=>Z(W,n)?Ms(n):0,e),ln=()=>U(()=>{js({}),t=!1}),es=()=>U(()=>{Es({}),s=!1}),mo=()=>U(()=>{ln(),es()}),ts=(e,n)=>{if(l!=-1){dn();const o=e();return fn(n),o}},dn=()=>(l!=-1&&l++,l==1&&(u[0]?.(),q(te)),Q),Co=()=>[se(S,(e,n)=>g(p,n)===-1?void 0:se(e,(o,i)=>g(g(x,n),i)===-1?void 0:se(o,([,c])=>c,c=>zt(c)),L,be),L,be),se(j,([,e])=>e,e=>zt(e)),1],Lo=()=>[!L(S),!L(j),Vt(S,mn,zt),Vt(E),se(j,mn,zt),se(k),se(p),as(x),Vt(b),se(F)],fn=e=>(l>0&&(l--,l==0&&(l=1,Js(1),L(S)||qs(1),Os(1),L(j)||Ks(1),e?.(Q)&&(w(S,(n,o)=>w(n,(i,c)=>w(i,([d],h)=>xn(Q,o,c,h,d)))),rs(S),w(j,([n],o)=>bn(Q,o,n)),rs(j)),q(ae[0],void 0),l=-1,Js(0),L(S)||qs(0),Os(0),L(j)||Ks(0),u[1]?.(),q(ae[1],void 0),u[2]?.(),l=0,r=St(),a=mt(),at([p,P,M,x,b,S,E,F,j,k],rs))),Q),Q={getContent:Xn,getTables:Xt,getTableIds:re,getTable:Qn,getTableCellIds:Xs,getRowCount:Qs,getRowIds:qe,getSortedRowIds:yt,getRow:Zn,getCellIds:Qt,getCell:xt,getValues:Zt,getValueIds:It,getValue:bt,hasTables:St,hasTable:Zs,hasTableCell:Is,hasRow:en,hasCell:tn,hasValues:mt,hasValue:sn,getTablesJson:In,getValuesJson:eo,getJson:to,getTablesSchemaJson:so,getValuesSchemaJson:no,getSchemaJson:oo,hasTablesSchema:()=>t,hasValuesSchema:()=>s,setContent:ro,setTables:Ct,setTable:io,setRow:co,addRow:ao,setPartialRow:lo,setCell:fo,setValues:Lt,setPartialValues:uo,setValue:go,applyChanges:ho,setTablesJson:nn,setValuesJson:po,setJson:yo,setTablesSchema:on,setValuesSchema:rn,setSchema:xo,delTables:Tt,delTable:cn,delRow:an,delCell:bo,delValues:Rt,delValue:So,delTablesSchema:ln,delValuesSchema:es,delSchema:mo,transaction:ts,startTransaction:dn,getTransactionChanges:Co,getTransactionLog:Lo,finishTransaction:fn,forEachTable:e=>w(v,(n,o)=>e(o,i=>w(n,(c,d)=>i(d,h=>Ne(c,h))))),forEachTableCell:(e,n)=>Ne(g(Y,N(e)),n),forEachRow:(e,n)=>w(g(v,N(e)),(o,i)=>n(i,c=>Ne(o,c))),forEachCell:(e,n,o)=>Ne(g(g(v,N(e)),N(n)),o),forEachValue:e=>Ne(W,e),addSortedRowIdsListener:(e,n,o,i,c,d,h)=>Ht(e)?Ys(e.tableId,e.cellId,[e.descending??!1,e.offset??0,e.limit],n,o):Ys(e,n,[o,i,c],d,h),addStartTransactionListener:e=>Ve(e,te),addWillFinishTransactionListener:e=>Ve(e,ae[0]),addDidFinishTransactionListener:e=>Ve(e,ae[1]),callListener:e=>(Wn(e),Q),delListener:e=>(Bn(e),Q),getListenerStats:()=>({hasTables:_(ne),tables:_(Se),tableIds:_(ge),hasTable:_(he),table:_(pe),tableCellIds:_(de),hasTableCell:_(we,ot),rowCount:_(ye),rowIds:_(xe),sortedRowIds:_(ee),hasRow:_(me,ot),row:_(je,ot),cellIds:_(y,ot),hasCell:_(C,os),cell:_(V,os),invalidCell:_(H,os),hasValues:_(Ce),values:_(Ee),valueIds:_(Me),hasValue:_(O),value:_(R),invalidValue:_(oe),transaction:Ss(te)+_(ae)}),isMergeable:()=>!1,createStore:Fn,addListener:Ve,callListeners:q,setInternalListeners:(e,n,o,i,c)=>u=[e,n,o,i,c]};return Fe({[Ae+gn]:[0,ne,[],()=>[St()]],[gn]:[0,Se],[Do]:[0,ge],[Ae+Xe]:[1,he,[re],e=>[Zs(...e)]],[Xe]:[1,pe,[re]],[Xe+hn]:[1,de,[re]],[Ae+Xe+Mt]:[2,we,[re,Xs],e=>[Is(...e)]],[Po]:[1,ye,[re]],[Mo]:[1,xe,[re]],[Ae+At]:[2,me,[re,qe],e=>[en(...e)]],[At]:[2,je,[re,qe]],[hn]:[2,y,[re,qe]],[Ae+Mt]:[3,C,[re,qe,Qt],e=>[tn(...e)]],[Mt]:[3,V,[re,qe,Qt],e=>$t(xt(...e))],InvalidCell:[3,H],[Ae+pn]:[0,Ce,[],()=>[mt()]],[pn]:[0,Ee],[Ao]:[0,Me],[Ae+Ut]:[1,O,[It],e=>[sn(...e)]],[Ut]:[1,R,[It],e=>$t(bt(e[0]))],InvalidValue:[1,oe]},([e,n,o,i],c)=>{Q[ko+c+No]=(...d)=>Ve(d[e],n[d[e+1]?1:0],e>0?yn(d,0,e):void 0,o,i)}),Zo(Q)},Jt="",Nn="￼",kn=t=>(s,r,a)=>t(s)?a?.():r(s),lr=globalThis,Cn=lr.window,fs=t=>t==null,De=t=>t===void 0,Dn=t=>t===null,dr=kn(fs),us=kn(De),gs=t=>Array.isArray(t),He=t=>t.length,fr=(t,s)=>t.test(s),Pn=t=>{throw new Error(t)},Ye=async(t,s,r)=>{try{return await t()}catch(a){s?.(a)}},hs=(t,s)=>t.forEach(s),ur=(t,s)=>t.splice(0,s),ms=(t,...s)=>t.push(...s),Mn=t=>t.shift(),Kt=Object,Ln=t=>Kt.getPrototypeOf(t),gr=t=>!fs(t)&&dr(Ln(t),s=>s==Kt.prototype||fs(Ln(s)),()=>!0),hr=Kt.keys,pr=Kt.freeze,yr=t=>He(hr(t)),Ft=t=>gr(t)&&yr(t)==0,xr=JSON.stringify,br=JSON.parse,Sr=t=>xr(t,(s,r)=>De(r)?Nn:r),Tn=t=>br(t,(s,r)=>r===Nn?void 0:r),mr=t=>t?.size??0,Cr=(t,s)=>t?.has(s)??!1,An=t=>De(t)||mr(t)==0,Un=(t,s)=>t?.forEach(s),_n=(t,s)=>t?.delete(s),dt=t=>new Map(t),fe=(t,s)=>t?.get(s),Je=(t,s,r)=>De(r)?(_n(t,s),t):t?.set(s,r),ps=(t,s,r,a)=>(Cr(t,s)?a?.(fe(t,s)):Je(t,s,r()),fe(t,s)),ys=(t,s,r,a,l=0)=>us((r?ps:fe)(t,s[l],l>He(s)-2?r:dt),u=>{if(l>He(s)-2)return a?.(u)&&Je(t,s[l]),u;const p=ys(u,s,r,a,l+1);return An(u)&&Je(t,s[l]),p}),Lr=/^\d+$/,Tr=()=>{const t=[];let s=0;return[r=>(r?Mn(t):null)??Jt+s++,r=>{fr(Lr,r)&&He(t)<1e3&&ms(t,r)}]},Rr=t=>new Set(gs(t)||De(t)?t:[t]),vr=(t,s)=>t?.add(s),wr=(t,s=[Jt])=>{const r=[],a=(l,u)=>u==He(s)?ms(r,l):Dn(s[u])?Un(l,p=>a(p,u+1)):hs([s[u],null],p=>a(fe(l,p),u+1));return a(t,0),r},jr=t=>{let s;const[r,a]=Tr(),l=dt();return[(x,b,S,F=[],j=()=>[])=>{s??=t();const E=r(1);return Je(l,E,[x,b,S,F,j]),vr(ys(b,S??[Jt],Rr),E),E},(x,b,...S)=>hs(wr(x,b),F=>Un(F,j=>fe(l,j)[0](s,...b??[],...S))),x=>us(fe(l,x),([,b,S])=>(ys(b,S??[Jt],void 0,F=>(_n(F,x),An(F)?1:0)),Je(l,x),a(x),S)),x=>us(fe(l,x),([b,,S=[],F,j])=>{const E=(...k)=>{const A=He(k);A==He(S)?b(s,...k,...j(k)):Dn(S[A])?hs(F[A]?.(...k)??[],G=>E(...k,G)):E(...k,S[A])};E()})]},Nt=dt(),kt=dt(),Er=(t=1,s,r)=>t!=1&&s.isMergeable()?[1,s.getMergeableContent,()=>s.getTransactionMergeableChanges(!r),([[a],[l]])=>!Ft(a)||!Ft(l),s.setDefaultContent]:t!=2?[0,s.getContent,s.getTransactionChanges,([a,l])=>!Ft(a)||!Ft(l),s.setContent]:Pn("Store type not supported by this Persister"),Vr=(t,s,r,a,l,u,p,P={},M=0,x=[])=>{let b=0,S=0,F=0,j,E,k;ps(Nt,x,()=>0),ps(kt,x,()=>[]);const A=dt(),[G,ie,ce,le,ue]=Er(p,t,M),[Y,v,W]=jr(()=>O),ne=R=>{R!=b&&(b=R,v(A,void 0,b))},Se=async()=>{if(!fe(Nt,x)){for(Je(Nt,x,1);!De(j=Mn(fe(kt,x)));)await Ye(j,u);Je(Nt,x,0)}},ge=R=>{(G&&gs(R?.[0])?R?.[2]===1?t.applyMergeableChanges:t.setMergeableContent:R?.[2]===1?t.applyChanges:t.setContent)(R)},he=async R=>(b!=2&&(ne(1),S++,await oe(async()=>{await Ye(async()=>{const te=await s();gs(te)?ge(te):R?ue(R):Pn(`Content is not an array: ${te}`)},()=>{R&&ue(R)}),ne(0)})),O),pe=async R=>(de(),await he(R),await Ye(async()=>E=await a(async(te,ae)=>{ae||te?b!=2&&(ne(1),S++,ge(ae??te),ne(0)):await he()}),u),O),de=async()=>(E&&(await Ye(()=>l(E),u),E=void 0),O),we=()=>!De(E),ye=async R=>(b!=1&&(ne(2),F++,await oe(async()=>{await Ye(()=>r(ie,R),u),ne(0)})),O),xe=async()=>(ee(),await ye(),k=t.addDidFinishTransactionListener(()=>{const R=ce();le(R)&&ye(R)}),O),ee=async()=>(k&&(t.delListener(k),k=void 0),O),me=()=>!De(k),je=async(R,te=!1)=>{const[ae,Ve]=te?[xe,pe]:[pe,xe];return await ae(R),await Ve(R),O},y=async(R=!1)=>{const[te,ae]=R?[ee,de]:[de,ee];return await te(),await ae(),O},C=()=>b,V=R=>Y(R,A),H=R=>(W(R),t),oe=async(...R)=>(ms(fe(kt,x),...R),await Se(),O),O={load:he,startAutoLoad:pe,stopAutoLoad:de,isAutoLoading:we,save:ye,startAutoSave:xe,stopAutoSave:ee,isAutoSaving:me,startAutoPersisting:je,stopAutoPersisting:y,getStatus:C,addStatusListener:V,delListener:H,schedule:oe,getStore:()=>t,destroy:()=>(ur(fe(kt,x)),y()),getStats:()=>({loads:S,saves:F}),...P};return pr(O)},Rn="storage",$r=(t,s,r,a)=>Vr(t,async()=>Tn(r.getItem(s)),async M=>r.setItem(s,Sr(M())),M=>{const x=b=>{b.storageArea===r&&b.key===s&&Ye(()=>M(Tn(b.newValue)),M)};return Cn.addEventListener(Rn,x),x},M=>Cn.removeEventListener(Rn,M),a,3,{getStorageName:()=>s}),zr=(t,s,r)=>$r(t,s,localStorage,r);function Fr(){return Fn()}function Nr(t){return zr(t,"trammel-codex")}function lt(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function Ot(t){return{x:t.cx,y:t.cy}}function kr(t,s){switch(s){case"topLeft":return{x:t.x,y:t.y};case"topRight":return{x:t.x+t.width,y:t.y};case"bottomLeft":return{x:t.x,y:t.y+t.height};case"bottomRight":return{x:t.x+t.width,y:t.y+t.height};default:return{x:t.x,y:t.y}}}function Dr(t,s){return typeof s=="number"?{x:t.x+s,y:t.y+s,width:t.width-s*2,height:t.height-s*2}:{x:t.x+s.left,y:t.y+s.top,width:t.width-s.left-s.right,height:t.height-s.top-s.bottom}}function Pr(t,s){const r="width"in t?lt(t):Ot(t),a="width"in s?lt(s):Ot(s);return{x:r.x,y:a.y}}function Mr(t,s){const r="width"in t?lt(t):Ot(t);return{x:("width"in s?lt(s):Ot(s)).x,y:r.y}}function Ar(t,s,r){if(t<=0)return[];const a=(r-t*s)/(t+1);return Array.from({length:t},(l,u)=>a+u*(s+a))}const Ur=Object.freeze(Object.defineProperty({__proto__:null,alignCenterX:Pr,alignCenterY:Mr,distributeEvenly:Ar,insetRect:Dr,rectCenter:lt,rectCorner:kr},Symbol.toStringTag,{value:"Module"}));let Dt=null;function _r(){return Dt||(Dt=(async()=>{const t=performance.now();try{const s=await Ro({locateFile:()=>vo});return wo(s),{ok:!0,ms:performance.now()-t}}catch(s){const r=s instanceof Error?s.message:String(s);return{ok:!1,ms:performance.now()-t,error:r}}})(),Dt)}const m={app:{fontFamily:"system-ui, -apple-system, Segoe UI, sans-serif",color:"#1f2933",background:"#f5f7fa",minHeight:"100vh"},header:{padding:"16px 24px 8px",display:"flex",alignItems:"baseline",gap:16},title:{margin:0,fontSize:22},subtitle:{margin:0,fontSize:13,color:"#52606d"},main:{display:"grid",gridTemplateColumns:"minmax(280px, 420px) minmax(360px, 1fr)",gap:16,padding:"12px 24px 24px"},panel:{background:"#fff",borderRadius:10,border:"1px solid #e4e7eb",padding:16,minHeight:520,display:"flex",flexDirection:"column"},panelHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},panelTitle:{margin:0,fontSize:13,textTransform:"uppercase",letterSpacing:1,color:"#52606d"},errorBadge:{display:"inline-flex",alignItems:"center",gap:6,fontSize:11,color:"#b91c1c",cursor:"pointer"},errorDot:{width:8,height:8,borderRadius:"50%",background:"#ef4444",boxShadow:"0 0 0 2px rgba(239, 68, 68, 0.2)"},editor:{width:"100%",maxWidth:420,flex:1,border:"1px solid #cbd2d9",borderRadius:8,padding:12,fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, monospace",fontSize:12.5,lineHeight:1.6,background:"#f8f9fa",color:"#102a43",boxSizing:"border-box"},actions:{display:"flex",gap:8,marginTop:10},button:{border:"1px solid #1f2933",background:"#1f2933",color:"#fff",padding:"6px 12px",borderRadius:6,fontSize:12,cursor:"pointer"},viewport:{flex:1,border:"1px dashed #cbd2d9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",background:"#fdfdfc",padding:8},footer:{marginTop:8,fontSize:12,color:"#7b8794"},diagnostics:{marginTop:12,padding:12,borderRadius:10,border:"1px solid #e4e7eb",background:"#f8fafc",fontSize:12,color:"#334e68"},diagTitle:{margin:"0 0 8px",fontSize:12,color:"#52606d",textTransform:"uppercase",letterSpacing:1},diagRow:{display:"flex",justifyContent:"space-between",gap:8,padding:"2px 0"},diagTabs:{display:"flex",gap:8,marginBottom:8},diagTab:{border:"1px solid #cbd2d9",background:"#fff",color:"#1f2933",padding:"2px 8px",borderRadius:999,fontSize:11,cursor:"pointer"},diagTabActive:{border:"1px solid #1f2933",background:"#1f2933",color:"#fff"},diagErrorBox:{marginTop:8,padding:8,borderRadius:8,border:"1px solid #fecaca",background:"#fff5f5",color:"#7f1d1d",whiteSpace:"pre-wrap"},tabs:{display:"flex",gap:8},tabButton:{border:"1px solid #cbd2d9",background:"#f8f9fa",color:"#1f2933",padding:"4px 10px",borderRadius:999,fontSize:12,cursor:"pointer"},tabButtonActive:{border:"1px solid #1f2933",background:"#1f2933",color:"#fff"},source:{width:"100%",height:"100%",padding:12,borderRadius:8,background:"#0b1215",color:"#e5e7eb",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, monospace",fontSize:12,overflow:"auto",whiteSpace:"pre"}},_e=`// trammel codex demo
const vars = {
  width: 320,
  height: 160,
  cornerRadius: 18,
  panel: '#f2f4f7',
  accent: '#2563eb',
  inset: 14,
  useReplicad: false,
};

const panel: Rect = { x: 0, y: 0, width: vars.width, height: vars.height };
const inner = insetRect(panel, vars.inset);
const badge = rectCorner(inner, 'topRight');

const Panel = () => (
  <g>
    <rect
      x={panel.x}
      y={panel.y}
      width={panel.width}
      height={panel.height}
      rx={vars.cornerRadius}
      fill={vars.panel}
      stroke="#0f172a"
      strokeWidth={2}
    />
    <circle cx={panel.width * 0.18} cy={panel.height * 0.5} r={22} fill={vars.accent} />
    <rect
      x={inner.x + 12}
      y={inner.y + 28}
      width={inner.width * 0.6}
      height={inner.height * 0.4}
      rx={12}
      fill="#e2e8f0"
      stroke="#0f172a"
      strokeWidth={1.5}
    />
    <circle cx={badge.x - 16} cy={badge.y + 16} r={8} fill={vars.accent} />
  </g>
);

const ReplicadPanel = () => {
  if (!vars.useReplicad) return null;
  const path = draw()
    .rect(vars.width, vars.height)
    .chamfer(6)
    .toSVGPaths()[0];
  return <path d={path} fill="none" stroke="#0f172a" strokeWidth={2} />;
};

const Root = () => (
  <svg viewBox={\`-10 -10 \${vars.width + 20} \${vars.height + 20}\`}>
    <Panel />
    <ReplicadPanel />
  </svg>
);
`;function Br({ready:t,children:s}){return t?f.jsx(f.Fragment,{children:s}):f.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,padding:"6px 10px",borderRadius:999,border:"1px solid #cbd2d9",background:"#f8fafc",color:"#52606d",fontSize:12},children:[f.jsx("span",{style:{width:10,height:10,borderRadius:"50%",border:"2px solid #cbd2d9",borderTopColor:"#1f2933",display:"inline-block",animation:"spin 1s linear infinite"}}),"Replicad loading…"]})}function Wr(t){try{const r=new DOMParser().parseFromString(t,"image/svg+xml").documentElement,a=[],l=(u,p)=>{const P="  ".repeat(p),M=Array.from(u.attributes).map(b=>` ${b.name}="${b.value}"`).join(""),x=Array.from(u.children);if(x.length===0){a.push(`${P}<${u.tagName}${M} />`);return}a.push(`${P}<${u.tagName}${M}>`),x.forEach(b=>l(b,p+1)),a.push(`${P}</${u.tagName}>`)};return l(r,0),a.join(`
`)}catch{return t}}function Be(t,s){try{const r=performance.now(),{code:a}=jo(t,{transforms:["typescript","jsx"]}),l=`
      const { useMemo, useState, useEffect, useRef } = React;
      const {
        rectCenter,
        rectCorner,
        insetRect,
        alignCenterX,
        alignCenterY,
        distributeEvenly,
      } = constraints;
      const draw = replicad.draw;
      ${a}
      if (typeof vars === 'object' && vars !== null) {
        Object.assign(vars, overrides ?? {});
      }
      const rootValue = typeof Root !== 'undefined' ? Root : null;
      const element = React.isValidElement(rootValue)
        ? rootValue
        : typeof rootValue === 'function'
          ? React.createElement(rootValue)
          : null;
      const capturedVars = typeof vars === 'object' && vars !== null ? vars : {};
      return { element, vars: capturedVars };
    `,p=new Function("React","constraints","replicad","overrides",l)(Pt,Ur,{draw:Eo},s),P=performance.now()-r;return{element:p.element,vars:p.vars,error:null,evalMs:P}}catch(r){if(r instanceof Error){const l=r.stack?`
${r.stack}`:"";return{element:null,vars:{},error:`${r.message}${l}`,evalMs:0}}return{element:null,vars:{},error:String(r),evalMs:0}}}function Gr(){const t=J.useMemo(()=>Fr(),[]),s=J.useMemo(()=>Nr(t),[t]),[r,a]=J.useState(_e),[l,u]=J.useState({}),[p,P]=J.useState(()=>Be(_e,{})),[M,x]=J.useState("visual"),[b,S]=J.useState(""),[F,j]=J.useState({nodes:0,bytes:0}),[E,k]=J.useState(0),[A,G]=J.useState([]),[ie,ce]=J.useState("info"),[le,ue]=J.useState(null),[Y,v]=J.useState({state:"idle",ms:0}),W=Pt.useRef(null),ne=Pt.useRef(null),Se=Pt.useRef(null),ge=()=>{P(Be(r,l)),G(y=>[`Ran eval (${r.length} chars)`,...y].slice(0,6))},he=()=>{a(_e),u({}),P(Be(_e,{}))},pe=()=>Se.current?.click(),de=()=>{const y=new Blob([r],{type:"text/plain"}),C=URL.createObjectURL(y),V=document.createElement("a");V.href=C,V.download="trammel-codex.tsx",V.click(),URL.revokeObjectURL(C)},we=()=>{const y=b||"";if(!y)return;const C=new Blob([y],{type:"image/svg+xml"}),V=URL.createObjectURL(C),H=document.createElement("a");H.href=V,H.download="trammel-codex.svg",H.click(),URL.revokeObjectURL(V)},ye=async y=>{const C=y.target.files?.[0];if(!C)return;const V=await C.text();a(V),u({}),P(Be(V,{})),G(H=>[`Imported ${C.name} (${C.size} bytes)`,...H].slice(0,6)),y.target.value=""},xe=y=>{(y.ctrlKey||y.metaKey)&&y.key==="Enter"&&(y.preventDefault(),ge())},ee=J.useMemo(()=>p.element,[p.element]);J.useEffect(()=>{let y=!1;return(async()=>{await s.startAutoLoad();const V=t.getCell("files","default","content");!y&&typeof V=="string"&&V.length>0?(a(V),P(Be(V,l)),G(H=>["Loaded saved file",...H].slice(0,6))):y||(t.setRow("files","default",{name:"main.tsx",content:_e}),a(_e),P(Be(_e,l)),G(H=>["Initialized default file",...H].slice(0,6))),s.startAutoSave()})(),()=>{y=!0,s.stopAutoSave()}},[s,t]),J.useEffect(()=>{t.setRow("files","default",{name:"main.tsx",content:r})},[r,t]),J.useEffect(()=>{const y=ne.current;if(!y)return;const C=y.querySelector("svg");if(!C){S(""),j({nodes:0,bytes:0});return}const V=performance.now(),oe=new XMLSerializer().serializeToString(C);S(Wr(oe)),k(performance.now()-V),j({nodes:C.querySelectorAll("*").length+1,bytes:oe.length}),G(Ce=>[`Serialized SVG (${oe.length} bytes, ${C.querySelectorAll("*").length+1} nodes)`,...Ce].slice(0,6))},[ee,p.error]),J.useEffect(()=>{!p.error||p.error===W.current||(W.current=p.error,G(y=>[`Eval error: ${p.error.split(`
`)[0]}`,...y].slice(0,6)),ue(p.error),ce("error"))},[p.error]),J.useEffect(()=>{let y=!0;return v(C=>({...C,state:"loading"})),G(C=>["Replicad init: starting",...C].slice(0,6)),_r().then(C=>{y&&(C.ok?(v({state:"ready",ms:C.ms}),G(V=>[`Replicad init: ok (${C.ms.toFixed(1)} ms)`,...V].slice(0,6))):(v({state:"error",ms:C.ms,error:C.error}),G(V=>[`Replicad init: error (${C.error??"unknown"})`,...V].slice(0,6))))}),()=>{y=!1}},[]),J.useEffect(()=>{p.error||W.current&&(W.current=null,ue(null),ce("info"),G(y=>y.filter(C=>!C.startsWith("Eval error: "))))},[p.error]);const me=Object.entries(p.vars??{}),je=typeof p.vars?.useReplicad=="boolean"?p.vars.useReplicad:!1;return f.jsxs("div",{style:m.app,children:[f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"}),f.jsxs("header",{style:m.header,children:[f.jsx("h1",{style:m.title,children:"trammel codex"}),f.jsx("p",{style:m.subtitle,children:"Editor left, SVG viewport right."})]}),f.jsxs("main",{style:m.main,children:[f.jsxs("section",{style:m.panel,children:[f.jsxs("div",{style:m.panelHeader,children:[f.jsx("h2",{style:m.panelTitle,children:"Editor"}),le?f.jsxs("button",{type:"button",onClick:()=>ce("error"),style:m.errorBadge,title:"View error details",children:[f.jsx("span",{style:m.errorDot}),"Error"]}):null]}),f.jsx("textarea",{style:m.editor,value:r,onChange:y=>a(y.target.value),onKeyDown:xe}),f.jsxs("div",{style:m.actions,children:[f.jsx("button",{style:m.button,type:"button",onClick:ge,children:"Run (Ctrl+Enter)"}),f.jsx("button",{style:{...m.button,background:"#e4e7eb",color:"#1f2933"},type:"button",onClick:he,children:"Reset Demo"}),f.jsx("button",{style:{...m.button,background:"#fff",color:"#1f2933"},type:"button",onClick:pe,children:"Import .tsx"}),f.jsx("button",{style:{...m.button,background:"#fff",color:"#1f2933"},type:"button",onClick:de,children:"Export .tsx"}),f.jsx("button",{style:{...m.button,background:"#fff",color:"#1f2933"},type:"button",onClick:we,disabled:!b,children:"Export .svg"})]}),f.jsx("input",{ref:Se,type:"file",accept:".tsx,.ts,.txt",style:{display:"none"},onChange:ye}),me.length>0?f.jsxs("div",{style:{marginTop:16},children:[f.jsx("h3",{style:{margin:"0 0 8px",fontSize:12,color:"#52606d"},children:"Variables"}),f.jsx("div",{style:{display:"grid",gap:8},children:me.map(([y,C])=>{const V=`var-${y}`,H=typeof C,Ce=H==="string"&&String(C).startsWith("#")?"color":H==="number"?"number":"text";return f.jsxs("label",{htmlFor:V,style:{display:"grid",gap:4},children:[f.jsx("span",{style:{fontSize:12,color:"#52606d"},children:y}),f.jsx("input",{id:V,type:Ce,value:String(l[y]??C),onChange:Ee=>{const Me=Ce==="number"?Number(Ee.target.value):Ee.target.value,O={...l,[y]:Me};u(O),P(Be(r,O))},style:{border:"1px solid #cbd2d9",borderRadius:6,padding:"6px 8px",fontSize:12}})]},y)})})]}):null]}),f.jsxs("section",{style:m.panel,children:[f.jsxs("div",{style:m.panelHeader,children:[f.jsx("h2",{style:m.panelTitle,children:"Viewport"}),f.jsxs("div",{style:m.tabs,children:[f.jsx("button",{type:"button",onClick:()=>x("visual"),style:{...m.tabButton,...M==="visual"?m.tabButtonActive:null},children:"Visual"}),f.jsx("button",{type:"button",onClick:()=>x("source"),style:{...m.tabButton,...M==="source"?m.tabButtonActive:null},children:"Source"})]})]}),f.jsx("div",{style:m.viewport,ref:ne,children:M==="visual"?je&&Y.state!=="ready"?f.jsx(Br,{ready:!1,children:ee}):ee:f.jsx("pre",{style:m.source,children:b||"No SVG rendered yet."})}),f.jsx("div",{style:m.footer,children:M==="visual"?"Rendered from eval output.":"Serialized SVG source."}),f.jsxs("div",{style:m.diagnostics,children:[f.jsx("h3",{style:m.diagTitle,children:"Diagnostics"}),f.jsxs("div",{style:m.diagTabs,children:[f.jsx("button",{type:"button",onClick:()=>ce("info"),style:{...m.diagTab,...ie==="info"?m.diagTabActive:null},children:"Info"}),f.jsx("button",{type:"button",onClick:()=>ce("error"),style:{...m.diagTab,...ie==="error"?m.diagTabActive:null},children:"Error"})]}),ie==="info"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"Eval time"}),f.jsxs("span",{children:[p.evalMs.toFixed(1)," ms"]})]}),f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"Serialize time"}),f.jsxs("span",{children:[E.toFixed(1)," ms"]})]}),f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"SVG nodes"}),f.jsx("span",{children:F.nodes})]}),f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"SVG size"}),f.jsxs("span",{children:[(F.bytes/1024).toFixed(1)," KB"]})]}),f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"Replicad"}),f.jsx("span",{children:Y.state==="ready"?`Ready (${Y.ms.toFixed(1)} ms)`:Y.state==="loading"?"Loading":Y.state==="error"?"Error":"Idle"})]}),Y.state==="error"&&Y.error?f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"Replicad error"}),f.jsx("span",{children:Y.error})]}):null,f.jsxs("div",{style:m.diagRow,children:[f.jsx("span",{children:"Last error"}),f.jsx("span",{children:le?le.split(`
`)[0]:"None"})]}),A.length>0?f.jsx("div",{style:{marginTop:8,display:"grid",gap:4},children:A.map((y,C)=>f.jsx("div",{style:{color:"#52606d"},children:y},`${y}-${C}`))}):null]}):f.jsx("div",{style:m.diagErrorBox,children:le||"No errors."})]})]})]})]})}function ri(){return f.jsx(Gr,{})}export{ri as CodexApp,ri as default};
